<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>cds_ng: CAuthManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cds_ng
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classCAuthManager.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classCAuthManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CAuthManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to manage user database, authentication operations.  
 <a href="classCAuthManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for CAuthManager:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager__coll__graph.png" border="0" usemap="#CAuthManager_coll__map" alt="Collaboration graph"/></div>
<map name="CAuthManager_coll__map" id="CAuthManager_coll__map">
<area shape="rect" id="node4" title="STL class. " alt="" coords="5,610,157,651"/><area shape="rect" id="node7" href="classCDataStore.html" title="Top&#45;level class containing all internal data. " alt="" coords="1387,1156,1483,1183"/><area shape="rect" id="node8" href="classCOpenAlarmsStore.html" title="For open alarms, we need to maintain a few parallel data structures, so to make sure they stay in syn..." alt="" coords="930,719,1075,745"/><area shape="rect" id="node17" title="STL class. " alt="" coords="427,1364,584,1391"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7fcac3f1bfa72364477eda06ef40217d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a7fcac3f1bfa72364477eda06ef40217d">CAuthManager</a> (const px::string &amp;db_path, const px::string &amp;passwd_path, const px::string &amp;role_config_dir, <a class="el" href="classCDataStore.html">CDataStore</a> &amp;cds)</td></tr>
<tr class="memdesc:a7fcac3f1bfa72364477eda06ef40217d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a7fcac3f1bfa72364477eda06ef40217d">More...</a><br/></td></tr>
<tr class="separator:a7fcac3f1bfa72364477eda06ef40217d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab043363e8bdf135202607f5d850e9b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abab043363e8bdf135202607f5d850e9b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#abab043363e8bdf135202607f5d850e9b">~CAuthManager</a> ()</td></tr>
<tr class="memdesc:abab043363e8bdf135202607f5d850e9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br/></td></tr>
<tr class="separator:abab043363e8bdf135202607f5d850e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b40b6b485762cd7df5750eff7e8a13"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03b40b6b485762cd7df5750eff7e8a13"></a>
std::vector&lt; px::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a03b40b6b485762cd7df5750eff7e8a13">GetUserNames</a> () const </td></tr>
<tr class="memdesc:a03b40b6b485762cd7df5750eff7e8a13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get list of user names. <br/></td></tr>
<tr class="separator:a03b40b6b485762cd7df5750eff7e8a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac853480182c1a3db862dd7579312f07f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac853480182c1a3db862dd7579312f07f"></a>
std::vector&lt; px::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ac853480182c1a3db862dd7579312f07f">GetUserOfRole</a> (const px::string &amp;role) const </td></tr>
<tr class="memdesc:ac853480182c1a3db862dd7579312f07f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get list of users from the same role. <br/></td></tr>
<tr class="separator:ac853480182c1a3db862dd7579312f07f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82f89a9eb4bcfd20e6894b46cc18104a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a82f89a9eb4bcfd20e6894b46cc18104a">GetUserInfo</a> (const px::string &amp;username, px::CUser &amp;info) const </td></tr>
<tr class="memdesc:a82f89a9eb4bcfd20e6894b46cc18104a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the CUser object for a user name.  <a href="#a82f89a9eb4bcfd20e6894b46cc18104a">More...</a><br/></td></tr>
<tr class="separator:a82f89a9eb4bcfd20e6894b46cc18104a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ea8572e021c78ca187ad8f82e25be1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac9ea8572e021c78ca187ad8f82e25be1"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ac9ea8572e021c78ca187ad8f82e25be1">IsUserChangeRole</a> (const px::CUser &amp;user) const </td></tr>
<tr class="memdesc:ac9ea8572e021c78ca187ad8f82e25be1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if user exists and role changed. <br/></td></tr>
<tr class="separator:ac9ea8572e021c78ca187ad8f82e25be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc45cf6615e81315229a29e4715daab9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc45cf6615e81315229a29e4715daab9"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#afc45cf6615e81315229a29e4715daab9">SetUserInfo</a> (const px::CUser &amp;info)</td></tr>
<tr class="memdesc:afc45cf6615e81315229a29e4715daab9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a user's information, creating it if necessary. <br/></td></tr>
<tr class="separator:afc45cf6615e81315229a29e4715daab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a8fb6339368d45e7934b5161dedfd8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a07a8fb6339368d45e7934b5161dedfd8">GetUserPasswordHash</a> (const px::string &amp;username, std::vector&lt; uint8_t &gt; &amp;hash, std::vector&lt; uint8_t &gt; &amp;<a class="el" href="classCAuthManager.html#a4746065a8e0f224081de90089986c018">htdigest_hash</a>)</td></tr>
<tr class="memdesc:a07a8fb6339368d45e7934b5161dedfd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a user's password hashes.  <a href="#a07a8fb6339368d45e7934b5161dedfd8">More...</a><br/></td></tr>
<tr class="separator:a07a8fb6339368d45e7934b5161dedfd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0acbd206b9b1a3dc330070ba39bd31b"><td class="memItemLeft" align="right" valign="top">enum <br class="typebreak"/>
px::proto::ChangePasswordStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b">SetUserPassword</a> (const px::string &amp;username, const px::string &amp;password)</td></tr>
<tr class="memdesc:ad0acbd206b9b1a3dc330070ba39bd31b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a user's plain-text password.  <a href="#ad0acbd206b9b1a3dc330070ba39bd31b">More...</a><br/></td></tr>
<tr class="separator:ad0acbd206b9b1a3dc330070ba39bd31b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab7a61094a0e9c8c3debfacbe4669ff"><td class="memItemLeft" align="right" valign="top">enum <br class="typebreak"/>
px::proto::ChangePasswordStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aaab7a61094a0e9c8c3debfacbe4669ff">SetUserPasswordHash</a> (const px::string &amp;username, const std::vector&lt; uint8_t &gt; &amp;hash)</td></tr>
<tr class="memdesc:aaab7a61094a0e9c8c3debfacbe4669ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a user's regular password hash.  <a href="#aaab7a61094a0e9c8c3debfacbe4669ff">More...</a><br/></td></tr>
<tr class="separator:aaab7a61094a0e9c8c3debfacbe4669ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5287651404fc92dfdd61a9e2f56b2bf2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a5287651404fc92dfdd61a9e2f56b2bf2">DeleteUser</a> (const px::string &amp;username)</td></tr>
<tr class="memdesc:a5287651404fc92dfdd61a9e2f56b2bf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a user.  <a href="#a5287651404fc92dfdd61a9e2f56b2bf2">More...</a><br/></td></tr>
<tr class="separator:a5287651404fc92dfdd61a9e2f56b2bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402fd33cfc7bc2ae62474c95b079fbf9"><td class="memItemLeft" align="right" valign="top">px::CBitset&lt; px::permissions &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9">AuthenticateUserPlainText</a> (const px::string &amp;username, const px::string &amp;service, const px::string &amp;password)</td></tr>
<tr class="memdesc:a402fd33cfc7bc2ae62474c95b079fbf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticate a user, given plain-text password.  <a href="#a402fd33cfc7bc2ae62474c95b079fbf9">More...</a><br/></td></tr>
<tr class="separator:a402fd33cfc7bc2ae62474c95b079fbf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a29b5e28ff20049c8e669c67c2a9037"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5a29b5e28ff20049c8e669c67c2a9037"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a5a29b5e28ff20049c8e669c67c2a9037">DBCorruptionDetected</a> () const </td></tr>
<tr class="memdesc:a5a29b5e28ff20049c8e669c67c2a9037"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate if database corruption has been detected. <br/></td></tr>
<tr class="separator:a5a29b5e28ff20049c8e669c67c2a9037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a337c02be9f2af7cecf1d016f1a7612e9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a337c02be9f2af7cecf1d016f1a7612e9"></a>
px::CBitset&lt; px::permissions &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a337c02be9f2af7cecf1d016f1a7612e9">client_perms</a> (int uid) const </td></tr>
<tr class="memdesc:a337c02be9f2af7cecf1d016f1a7612e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the permissions for a client by Linux UID. <br/></td></tr>
<tr class="separator:a337c02be9f2af7cecf1d016f1a7612e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a199ba6dee5b9b1e8f3a35c43f0e7c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a199ba6dee5b9b1e8f3a35c43f0e7c9"></a>
px::CBitset&lt; px::permissions &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a4a199ba6dee5b9b1e8f3a35c43f0e7c9">group_perms</a> (const std::unordered_set&lt; int &gt; &amp;gids) const </td></tr>
<tr class="memdesc:a4a199ba6dee5b9b1e8f3a35c43f0e7c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the permissions for a set of Linux GIDs. <br/></td></tr>
<tr class="separator:a4a199ba6dee5b9b1e8f3a35c43f0e7c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea76a8159d5a43252441573f7962f72"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ea76a8159d5a43252441573f7962f72"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a9ea76a8159d5a43252441573f7962f72">GetRoleList</a> (std::unordered_set&lt; px::string &gt; &amp;role_list) const </td></tr>
<tr class="memdesc:a9ea76a8159d5a43252441573f7962f72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the list of defined roles. <br/></td></tr>
<tr class="separator:a9ea76a8159d5a43252441573f7962f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55013bab04186f85f3c96b949836c1d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa55013bab04186f85f3c96b949836c1d"></a>
px::CBitset&lt; px::permissions &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aa55013bab04186f85f3c96b949836c1d">GetRolePermissions</a> (const px::string &amp;role) const </td></tr>
<tr class="memdesc:aa55013bab04186f85f3c96b949836c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the permissions associated with a role. <br/></td></tr>
<tr class="separator:aa55013bab04186f85f3c96b949836c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17ee9691f3b4d97f8367eca32e53e6d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aa17ee9691f3b4d97f8367eca32e53e6d">DeleteRole</a> (const px::string &amp;role)</td></tr>
<tr class="memdesc:aa17ee9691f3b4d97f8367eca32e53e6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a role.  <a href="#aa17ee9691f3b4d97f8367eca32e53e6d">More...</a><br/></td></tr>
<tr class="separator:aa17ee9691f3b4d97f8367eca32e53e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f8d2b7f588abd875d78c6aad537833a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a4f8d2b7f588abd875d78c6aad537833a">UpdateRole</a> (const px::string &amp;role_name, const px::string &amp;old_role_name, const px::CBitset&lt; px::permissions &gt; &amp;perms)</td></tr>
<tr class="memdesc:a4f8d2b7f588abd875d78c6aad537833a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update or create a role.  <a href="#a4f8d2b7f588abd875d78c6aad537833a">More...</a><br/></td></tr>
<tr class="separator:a4f8d2b7f588abd875d78c6aad537833a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a278aa8838f4a91647254bd077ad99fb1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a278aa8838f4a91647254bd077ad99fb1">IsValidRole</a> (const px::string &amp;role_name)</td></tr>
<tr class="memdesc:a278aa8838f4a91647254bd077ad99fb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate a role.  <a href="#a278aa8838f4a91647254bd077ad99fb1">More...</a><br/></td></tr>
<tr class="separator:a278aa8838f4a91647254bd077ad99fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa88cec92e7e8f6f8abb585a2edc958c1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aa88cec92e7e8f6f8abb585a2edc958c1">SetHashStrength</a> (uint8_t strength)</td></tr>
<tr class="memdesc:aa88cec92e7e8f6f8abb585a2edc958c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the bcrypt strength parameter for new hashes.  <a href="#aa88cec92e7e8f6f8abb585a2edc958c1">More...</a><br/></td></tr>
<tr class="separator:aa88cec92e7e8f6f8abb585a2edc958c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaab9d5054228ee223047c681fb5d211"><td class="memItemLeft" align="right" valign="top">std::vector&lt; uint8_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#abaab9d5054228ee223047c681fb5d211">bcrypt_hash</a> (const px::string &amp;salt, const px::string &amp;password) const </td></tr>
<tr class="memdesc:abaab9d5054228ee223047c681fb5d211"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash a password, bcrypt style.  <a href="#abaab9d5054228ee223047c681fb5d211">More...</a><br/></td></tr>
<tr class="separator:abaab9d5054228ee223047c681fb5d211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec7a3abc679fbb6a988276aa95662a31"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aec7a3abc679fbb6a988276aa95662a31">get_global_password_policy</a> (px::CUserPolicy &amp;policy)</td></tr>
<tr class="memdesc:aec7a3abc679fbb6a988276aa95662a31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get global password Policy information.  <a href="#aec7a3abc679fbb6a988276aa95662a31">More...</a><br/></td></tr>
<tr class="separator:aec7a3abc679fbb6a988276aa95662a31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a1b2fed6a03e718e437ee9fd6bfa78"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a92a1b2fed6a03e718e437ee9fd6bfa78">set_global_password_policy</a> (const px::CUserPolicy &amp;policy)</td></tr>
<tr class="memdesc:a92a1b2fed6a03e718e437ee9fd6bfa78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set global password Policy information.  <a href="#a92a1b2fed6a03e718e437ee9fd6bfa78">More...</a><br/></td></tr>
<tr class="separator:a92a1b2fed6a03e718e437ee9fd6bfa78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2f9a31177a8eb0154ec2c998c0e4944"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ad2f9a31177a8eb0154ec2c998c0e4944">CheckUsersPassword</a> (const px::string &amp;username, const px::string &amp;password)</td></tr>
<tr class="memdesc:ad2f9a31177a8eb0154ec2c998c0e4944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check a user's plain text password.  <a href="#ad2f9a31177a8eb0154ec2c998c0e4944">More...</a><br/></td></tr>
<tr class="separator:ad2f9a31177a8eb0154ec2c998c0e4944"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4746065a8e0f224081de90089986c018"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; uint8_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a4746065a8e0f224081de90089986c018">htdigest_hash</a> (const px::string &amp;username, const px::string &amp;password)</td></tr>
<tr class="memdesc:a4746065a8e0f224081de90089986c018"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash a password, htdigest style, using above realm.  <a href="#a4746065a8e0f224081de90089986c018">More...</a><br/></td></tr>
<tr class="separator:a4746065a8e0f224081de90089986c018"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a8a7bf02e55f2b2017cd4462dbd41533c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="memdesc:a8a7bf02e55f2b2017cd4462dbd41533c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enum defines various keys used in database. <br/></td></tr>
<tr class="separator:a8a7bf02e55f2b2017cd4462dbd41533c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a49e6a6a98f44a3ce01f4d43fc46d767c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49e6a6a98f44a3ce01f4d43fc46d767c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a49e6a6a98f44a3ce01f4d43fc46d767c">load_users_and_roles</a> (const px::string &amp;role_config_dir)</td></tr>
<tr class="memdesc:a49e6a6a98f44a3ce01f4d43fc46d767c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load user data, role definitions from persistent storage. <br/></td></tr>
<tr class="separator:a49e6a6a98f44a3ce01f4d43fc46d767c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d858b3c2ea625cb8e8324537305e6b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5d858b3c2ea625cb8e8324537305e6b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aa5d858b3c2ea625cb8e8324537305e6b">save_user</a> (const px::string &amp;username)</td></tr>
<tr class="memdesc:aa5d858b3c2ea625cb8e8324537305e6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write this user's info to the auth DB. <br/></td></tr>
<tr class="separator:aa5d858b3c2ea625cb8e8324537305e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcddd820ca75d47f7041359231722f45"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abcddd820ca75d47f7041359231722f45"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#abcddd820ca75d47f7041359231722f45">save_role</a> (const px::string &amp;role_name, const px::CBitset&lt; px::permissions &gt; &amp;perms)</td></tr>
<tr class="memdesc:abcddd820ca75d47f7041359231722f45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write this role's permission mapping to the auth DB. <br/></td></tr>
<tr class="separator:abcddd820ca75d47f7041359231722f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3bca933124d5ee5e738263dcc2e0bc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6a3bca933124d5ee5e738263dcc2e0bc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a6a3bca933124d5ee5e738263dcc2e0bc">migrate_auth_db</a> (px::db::CKeyValueStore &amp;auth_db)</td></tr>
<tr class="memdesc:a6a3bca933124d5ee5e738263dcc2e0bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrate prior versions of the auth DB to the current version. <br/></td></tr>
<tr class="separator:a6a3bca933124d5ee5e738263dcc2e0bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a664254c0d548d56db60d3667919100d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a664254c0d548d56db60d3667919100d3">update_passwd_ssh</a> ()</td></tr>
<tr class="memdesc:a664254c0d548d56db60d3667919100d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update /etc/passwd file as necessary for SSH-capable users.  <a href="#a664254c0d548d56db60d3667919100d3">More...</a><br/></td></tr>
<tr class="separator:a664254c0d548d56db60d3667919100d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13eb67d8ef161f4cbb3d693c53ba147a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a13eb67d8ef161f4cbb3d693c53ba147a">canUpdateUser</a> (const px::string &amp;username, const px::string &amp;new_role=&quot;&quot;)</td></tr>
<tr class="memdesc:a13eb67d8ef161f4cbb3d693c53ba147a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we can update or delete a user.  <a href="#a13eb67d8ef161f4cbb3d693c53ba147a">More...</a><br/></td></tr>
<tr class="separator:a13eb67d8ef161f4cbb3d693c53ba147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a822b1830a3adf5907928f1acd0cf56fb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a822b1830a3adf5907928f1acd0cf56fb">canUpdateRole</a> (const px::string &amp;role, const px::CBitset&lt; px::permissions &gt; &amp;perms=px::CBitset&lt; px::permissions &gt;())</td></tr>
<tr class="memdesc:a822b1830a3adf5907928f1acd0cf56fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we can update or delete a role.  <a href="#a822b1830a3adf5907928f1acd0cf56fb">More...</a><br/></td></tr>
<tr class="separator:a822b1830a3adf5907928f1acd0cf56fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa3485b7f7039265c8a2c746bb89454"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a5aa3485b7f7039265c8a2c746bb89454">save_policy</a> (const px::CUserPolicy &amp;policy)</td></tr>
<tr class="memdesc:a5aa3485b7f7039265c8a2c746bb89454"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves global password policy to DB.  <a href="#a5aa3485b7f7039265c8a2c746bb89454">More...</a><br/></td></tr>
<tr class="separator:a5aa3485b7f7039265c8a2c746bb89454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b699c18d24e72ee95bb15550a26428b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a0b699c18d24e72ee95bb15550a26428b">update_password_history</a> (const px::string user_id, const std::vector&lt; uint8_t &gt; &amp;hash)</td></tr>
<tr class="memdesc:a0b699c18d24e72ee95bb15550a26428b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates user password history with the new password.  <a href="#a0b699c18d24e72ee95bb15550a26428b">More...</a><br/></td></tr>
<tr class="separator:a0b699c18d24e72ee95bb15550a26428b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43db0fde43b7b643cee28139d9e8128"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ac43db0fde43b7b643cee28139d9e8128">save_password_history</a> (const px::string user_name, std::vector&lt; std::vector&lt; uint8_t &gt; &gt; &amp;pw_history)</td></tr>
<tr class="memdesc:ac43db0fde43b7b643cee28139d9e8128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves the password history for the given user.  <a href="#ac43db0fde43b7b643cee28139d9e8128">More...</a><br/></td></tr>
<tr class="separator:ac43db0fde43b7b643cee28139d9e8128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22812def60fa13bea7e10043180d06b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ae22812def60fa13bea7e10043180d06b">find_password</a> (const px::string &amp;user_name, const px::string &amp;password, size_t password_depth) const </td></tr>
<tr class="memdesc:ae22812def60fa13bea7e10043180d06b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Looks for the given password in the password history of the user.  <a href="#ae22812def60fa13bea7e10043180d06b">More...</a><br/></td></tr>
<tr class="separator:ae22812def60fa13bea7e10043180d06b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b5870678ebb08c84dcf9a1d3cbb6aa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a85b5870678ebb08c84dcf9a1d3cbb6aa">password_check</a> (const px::string &amp;user_name, const px::string &amp;password, const std::vector&lt; uint8_t &gt; &amp;hash) const </td></tr>
<tr class="memdesc:a85b5870678ebb08c84dcf9a1d3cbb6aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the given string password matches given hash password.  <a href="#a85b5870678ebb08c84dcf9a1d3cbb6aa">More...</a><br/></td></tr>
<tr class="separator:a85b5870678ebb08c84dcf9a1d3cbb6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e0a14d469929e487393244ccd81f46"><td class="memItemLeft" align="right" valign="top">enum <br class="typebreak"/>
px::proto::ChangePasswordStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a51e0a14d469929e487393244ccd81f46">password_policy_check</a> (const px::string &amp;username, const px::string &amp;password) const </td></tr>
<tr class="memdesc:a51e0a14d469929e487393244ccd81f46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for password policy fulfillment.  <a href="#a51e0a14d469929e487393244ccd81f46">More...</a><br/></td></tr>
<tr class="separator:a51e0a14d469929e487393244ccd81f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a211476e4d4d3093f0330f8c0d34c373e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a211476e4d4d3093f0330f8c0d34c373e">migrate_htdigest_to_bcrypt</a> (const px::string &amp;username, const px::string &amp;password, const std::vector&lt; uint8_t &gt; &amp;<a class="el" href="classCAuthManager.html#a4746065a8e0f224081de90089986c018">htdigest_hash</a>)</td></tr>
<tr class="memdesc:a211476e4d4d3093f0330f8c0d34c373e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrates an htdigest password to bcrypt for UL security requirements.  <a href="#a211476e4d4d3093f0330f8c0d34c373e">More...</a><br/></td></tr>
<tr class="separator:a211476e4d4d3093f0330f8c0d34c373e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4f2d2beda38634f37a7e7cdd90686246"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4f2d2beda38634f37a7e7cdd90686246"></a>
px::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a4f2d2beda38634f37a7e7cdd90686246">_db_path</a></td></tr>
<tr class="memdesc:a4f2d2beda38634f37a7e7cdd90686246"><td class="mdescLeft">&#160;</td><td class="mdescRight">Paths to database directory, passwd files. <br/></td></tr>
<tr class="separator:a4f2d2beda38634f37a7e7cdd90686246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a875a219870c955daad0668f275501a7f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a875a219870c955daad0668f275501a7f"></a>
<a class="el" href="classCDataStore.html">CDataStore</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a875a219870c955daad0668f275501a7f">_cds</a></td></tr>
<tr class="memdesc:a875a219870c955daad0668f275501a7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">System's <a class="el" href="classCDataStore.html" title="Top-level class containing all internal data. ">CDataStore</a>, to access LDAP OOBs. <br/></td></tr>
<tr class="separator:a875a219870c955daad0668f275501a7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a353de87a7297243c6a85f5e06467f847"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; px::string, <br class="typebreak"/>
px::CUser &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a353de87a7297243c6a85f5e06467f847">_users</a></td></tr>
<tr class="memdesc:a353de87a7297243c6a85f5e06467f847"><td class="mdescLeft">&#160;</td><td class="mdescRight">Currently defined users Key: user id.  <a href="#a353de87a7297243c6a85f5e06467f847">More...</a><br/></td></tr>
<tr class="separator:a353de87a7297243c6a85f5e06467f847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7009ffce48347ace7c38fd691710d00"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7009ffce48347ace7c38fd691710d00"></a>
std::unordered_map&lt; px::string, <br class="typebreak"/>
std::vector&lt; uint8_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ad7009ffce48347ace7c38fd691710d00">_htdigests</a></td></tr>
<tr class="memdesc:ad7009ffce48347ace7c38fd691710d00"><td class="mdescLeft">&#160;</td><td class="mdescRight">htdigest password hashes for each user. <br/></td></tr>
<tr class="separator:ad7009ffce48347ace7c38fd691710d00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc735e6980dca017f2103ad27c621db"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3fc735e6980dca017f2103ad27c621db"></a>
std::unordered_map&lt; px::string, <br class="typebreak"/>
std::vector&lt; uint8_t &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a3fc735e6980dca017f2103ad27c621db">_hashes</a></td></tr>
<tr class="memdesc:a3fc735e6980dca017f2103ad27c621db"><td class="mdescLeft">&#160;</td><td class="mdescRight">bcrypt password hashes for each user. <br/></td></tr>
<tr class="separator:a3fc735e6980dca017f2103ad27c621db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ab9cfba35a0622c70be36b55cbf41d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab9ab9cfba35a0622c70be36b55cbf41d"></a>
std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ab9ab9cfba35a0622c70be36b55cbf41d">_mutex</a></td></tr>
<tr class="memdesc:ab9ab9cfba35a0622c70be36b55cbf41d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex to serialize access to members. <br/></td></tr>
<tr class="separator:ab9ab9cfba35a0622c70be36b55cbf41d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3b9ebeb7abd4b53a5dd8a17f29db43"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aac3b9ebeb7abd4b53a5dd8a17f29db43"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#aac3b9ebeb7abd4b53a5dd8a17f29db43">_db_corruption_detected</a></td></tr>
<tr class="memdesc:aac3b9ebeb7abd4b53a5dd8a17f29db43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag set if DB corruption detected, so CDS main can see, notify user. <br/></td></tr>
<tr class="separator:aac3b9ebeb7abd4b53a5dd8a17f29db43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a697cc3e11ff0c3a6d9cdddc23d7e5afd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a697cc3e11ff0c3a6d9cdddc23d7e5afd"></a>
std::unordered_map&lt; int, <br class="typebreak"/>
px::CBitset&lt; px::permissions &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a697cc3e11ff0c3a6d9cdddc23d7e5afd">_uid_perms</a></td></tr>
<tr class="memdesc:a697cc3e11ff0c3a6d9cdddc23d7e5afd"><td class="mdescLeft">&#160;</td><td class="mdescRight">permissions to CDS clients based on Linux system users UID (UID &lt; 1000) <br/></td></tr>
<tr class="separator:a697cc3e11ff0c3a6d9cdddc23d7e5afd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8773c5b59a6aca77da4418b1b891ba69"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8773c5b59a6aca77da4418b1b891ba69"></a>
std::unordered_map&lt; int, <br class="typebreak"/>
px::CBitset&lt; px::permissions &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a8773c5b59a6aca77da4418b1b891ba69">_gid_perms</a></td></tr>
<tr class="memdesc:a8773c5b59a6aca77da4418b1b891ba69"><td class="mdescLeft">&#160;</td><td class="mdescRight">permissions to CDS clients based on Linux system GID <br/></td></tr>
<tr class="separator:a8773c5b59a6aca77da4418b1b891ba69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7cd873f0e09bdcfa1fc537091bc9dc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e7cd873f0e09bdcfa1fc537091bc9dc"></a>
std::unordered_map&lt; int, <br class="typebreak"/>
px::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a0e7cd873f0e09bdcfa1fc537091bc9dc">_client_perms</a></td></tr>
<tr class="memdesc:a0e7cd873f0e09bdcfa1fc537091bc9dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Role to CDS clients based on Linux troubleshoot users UID (UID &gt; 1000) <br/></td></tr>
<tr class="separator:a0e7cd873f0e09bdcfa1fc537091bc9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab922ba54d4c59401cb568e8840033996"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab922ba54d4c59401cb568e8840033996"></a>
std::unordered_map&lt; px::string, <br class="typebreak"/>
px::CBitset&lt; px::permissions &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ab922ba54d4c59401cb568e8840033996">_role_perms</a></td></tr>
<tr class="memdesc:ab922ba54d4c59401cb568e8840033996"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of roles and their permissions. <br/></td></tr>
<tr class="separator:ab922ba54d4c59401cb568e8840033996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a344dd9adea9ae86e784535b74263c107"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a344dd9adea9ae86e784535b74263c107"></a>
gid_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a344dd9adea9ae86e784535b74263c107">_sshusers_gid</a></td></tr>
<tr class="memdesc:a344dd9adea9ae86e784535b74263c107"><td class="mdescLeft">&#160;</td><td class="mdescRight">Group ID of 'sshusers'. <br/></td></tr>
<tr class="separator:a344dd9adea9ae86e784535b74263c107"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953653140cb790c5148b22bb6653063d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a953653140cb790c5148b22bb6653063d"></a>
uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a953653140cb790c5148b22bb6653063d">_bcrypt_strength</a></td></tr>
<tr class="memdesc:a953653140cb790c5148b22bb6653063d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log2 of number of rounds to run bcrypt hashes, set by <a class="el" href="classCAuthManager.html#aa88cec92e7e8f6f8abb585a2edc958c1" title="Set the bcrypt strength parameter for new hashes. ">SetHashStrength()</a>. <br/></td></tr>
<tr class="separator:a953653140cb790c5148b22bb6653063d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1303768672dcf51530be75daac14f003"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1303768672dcf51530be75daac14f003"></a>
px::CUserPolicy&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a1303768672dcf51530be75daac14f003">_gbl_passwd_policy</a></td></tr>
<tr class="memdesc:a1303768672dcf51530be75daac14f003"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the global password policy defined. <br/></td></tr>
<tr class="separator:a1303768672dcf51530be75daac14f003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37571a4538cd5b59db4e8245d0361fc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab37571a4538cd5b59db4e8245d0361fc"></a>
std::unordered_map&lt; px::string, <br class="typebreak"/>
std::vector&lt; std::vector<br class="typebreak"/>
&lt; uint8_t &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#ab37571a4538cd5b59db4e8245d0361fc">_passwd_history</a></td></tr>
<tr class="memdesc:ab37571a4538cd5b59db4e8245d0361fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds password history for all users in bcrypt/hash format. <br/></td></tr>
<tr class="separator:ab37571a4538cd5b59db4e8245d0361fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:acea1becf9e8f5f4183c79d3b254fbf85"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#acea1becf9e8f5f4183c79d3b254fbf85">_default_strength</a> = 9</td></tr>
<tr class="memdesc:acea1becf9e8f5f4183c79d3b254fbf85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default bcrypt hash strength setting if <a class="el" href="classCAuthManager.html#aa88cec92e7e8f6f8abb585a2edc958c1" title="Set the bcrypt strength parameter for new hashes. ">SetHashStrength()</a> has not been called.  <a href="#acea1becf9e8f5f4183c79d3b254fbf85">More...</a><br/></td></tr>
<tr class="separator:acea1becf9e8f5f4183c79d3b254fbf85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe3040daa7e834c5026c5d578165ee55"><td class="memItemLeft" align="right" valign="top">static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#afe3040daa7e834c5026c5d578165ee55">_default_no_of_pw</a> = 32</td></tr>
<tr class="memdesc:afe3040daa7e834c5026c5d578165ee55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default no.  <a href="#afe3040daa7e834c5026c5d578165ee55">More...</a><br/></td></tr>
<tr class="separator:afe3040daa7e834c5026c5d578165ee55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a461974bdafa0cb549378f5fc2b5c6147"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a461974bdafa0cb549378f5fc2b5c6147"></a>
static const uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a461974bdafa0cb549378f5fc2b5c6147">_db_key_size</a> = 1</td></tr>
<tr class="memdesc:a461974bdafa0cb549378f5fc2b5c6147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Database key size in bytes. <br/></td></tr>
<tr class="separator:a461974bdafa0cb549378f5fc2b5c6147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819a3cd86db811d16460b2c5a43f744b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a819a3cd86db811d16460b2c5a43f744b"></a>
static const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCAuthManager.html#a819a3cd86db811d16460b2c5a43f744b">_secs_per_day</a> = 86400UL</td></tr>
<tr class="memdesc:a819a3cd86db811d16460b2c5a43f744b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seconds in a day. <br/></td></tr>
<tr class="separator:a819a3cd86db811d16460b2c5a43f744b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to manage user database, authentication operations. </p>
<p>Methods are safe to call in multiple threads concurrently, except where noted otherwise. </p>

<p>Definition at line <a class="el" href="auth__manager_8hpp_source.html#l00037">37</a> of file <a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7fcac3f1bfa72364477eda06ef40217d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CAuthManager::CAuthManager </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>db_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>passwd_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>role_config_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCDataStore.html">CDataStore</a> &amp;&#160;</td>
          <td class="paramname"><em>cds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Takes paths to: DB directory, /etc/passwd file, and directory from which to load roles.</p>
<p>Loads user info from DB, updates passwd file. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00041">41</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a82f89a9eb4bcfd20e6894b46cc18104a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::GetUserInfo </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">px::CUser &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the CUser object for a user name. </p>
<p>Returns true if the user exists, false if not. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00670">670</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a07a8fb6339368d45e7934b5161dedfd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::GetUserPasswordHash </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>htdigest_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a user's password hashes. </p>
<p>Returns true on success, false on failure (such as nonexistent user). One or both hashes may be empty. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00706">706</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad0acbd206b9b1a3dc330070ba39bd31b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum px::proto::ChangePasswordStatus CAuthManager::SetUserPassword </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a user's plain-text password. </p>
<p>Returns true on success, false on failure (such as nonexistent user). </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01322">1322</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aaab7a61094a0e9c8c3debfacbe4669ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum px::proto::ChangePasswordStatus CAuthManager::SetUserPasswordHash </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a user's regular password hash. </p>
<p>Returns true on success, false on failure. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01356">1356</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5287651404fc92dfdd61a9e2f56b2bf2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::DeleteUser </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a user. </p>
<p>Returns false if user was not found or deleted. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01119">1119</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a402fd33cfc7bc2ae62474c95b079fbf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">px::CBitset&lt; px::permissions &gt; CAuthManager::AuthenticateUserPlainText </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authenticate a user, given plain-text password. </p>
<p>Returns list of permissions (empty if user does not exist or provided password incorrect or service not in allowed list). </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01628">1628</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa17ee9691f3b4d97f8367eca32e53e6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::DeleteRole </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>role</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role</td><td>Role to delete. Users assigned to that role need to get otherwise assigned to a different one. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True of the role had existed, false otherwise. </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02006">2006</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4f8d2b7f588abd875d78c6aad537833a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::UpdateRole </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>role_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>old_role_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::CBitset&lt; px::permissions &gt; &amp;&#160;</td>
          <td class="paramname"><em>perms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update or create a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role_name</td><td>Name of the role. </td></tr>
    <tr><td class="paramname">old_role_name</td><td>If the role is to be renamed, the name it was using before. Users assigned to that role will be updated accordingly. </td></tr>
    <tr><td class="paramname">perms</td><td>Permissions to be assigned to the role. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false if not </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02059">2059</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a278aa8838f4a91647254bd077ad99fb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::IsValidRole </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>role_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validate a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role_name</td><td>Name of the role. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if successful, false if not </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01256">1256</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa88cec92e7e8f6f8abb585a2edc958c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::SetHashStrength </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>strength</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the bcrypt strength parameter for new hashes. </p>
<p>Values from 0 through 31 inclusive are legal. The computation gets harder as 2^N as this parameter N increases. Default, if this is never called, is _default_strength. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">strength</td><td>Strength factor, 0-31 inclusive </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True for success, false for failure </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02388">2388</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="abaab9d5054228ee223047c681fb5d211"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; uint8_t &gt; CAuthManager::bcrypt_hash </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hash a password, bcrypt style. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">salt</td><td>The prefix "$2b$NN$ssssssssssssssssssssss", where NN is a decimal number 0-31 indicating how many rounds (2^NN) to use, and ssss.... is a random 22-character base64 string (16 binary bytes) stored with the hash. </td></tr>
    <tr><td class="paramname">password</td><td>The password to be hashed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Hashed salt and password. If salt is empty, a random one is generated, with NN being the value set by a call to SetHashingRounds(), or the system default. Returned hash has the format "$2b$NN$ssssssssssssssssssssshhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh" where hhhh... is the hash, in base64. </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00609">609</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_abaab9d5054228ee223047c681fb5d211_icgraph.png" border="0" usemap="#classCAuthManager_abaab9d5054228ee223047c681fb5d211_icgraph" alt=""/></div>
<map name="classCAuthManager_abaab9d5054228ee223047c681fb5d211_icgraph" id="classCAuthManager_abaab9d5054228ee223047c681fb5d211_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a85b5870678ebb08c84dcf9a1d3cbb6aa" title="Checks if the given string password matches given hash password. " alt="" coords="259,5,445,46"/><area shape="rect" id="node8" href="classCAuthManager.html#a211476e4d4d3093f0330f8c0d34c373e" title="Migrates an htdigest password to bcrypt for UL security requirements. " alt="" coords="264,70,440,111"/><area shape="rect" id="node5" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="1000,75,1237,101"/><area shape="rect" id="node3" href="classCAuthManager.html#ae22812def60fa13bea7e10043180d06b" title="Looks for the given password in the password history of the user. " alt="" coords="520,5,669,46"/><area shape="rect" id="node6" href="classCAuthManager.html#ad2f9a31177a8eb0154ec2c998c0e4944" title="Check a user&#39;s plain text password. " alt="" coords="493,70,696,111"/><area shape="rect" id="node4" href="classCAuthManager.html#a51e0a14d469929e487393244ccd81f46" title="Checks for password policy fulfillment. " alt="" coords="755,5,941,46"/><area shape="rect" id="node7" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9" title="Authenticate a user, given plain&#45;text password. " alt="" coords="744,70,952,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aec7a3abc679fbb6a988276aa95662a31"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::get_global_password_policy </td>
          <td>(</td>
          <td class="paramtype">px::CUserPolicy &amp;&#160;</td>
          <td class="paramname"><em>policy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get global password Policy information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">policy[OUT]</td><td>- Global Password Policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if global password policy is retrieved successfully, else fail </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02408">2408</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a92a1b2fed6a03e718e437ee9fd6bfa78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::set_global_password_policy </td>
          <td>(</td>
          <td class="paramtype">const px::CUserPolicy &amp;&#160;</td>
          <td class="paramname"><em>policy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set global password Policy information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">policy[IN]</td><td>- Global Password Policy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if global password policy is set successfully, else fail </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02419">2419</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad2f9a31177a8eb0154ec2c998c0e4944"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::CheckUsersPassword </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check a user's plain text password. </p>
<p>For e.g. checking current password before changing; use AuthenticateUserPlainText for login as it does more checking and logging (e.g. password expiration, lockout). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">username</td><td>User Name </td></tr>
    <tr><td class="paramname">password</td><td>Password to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if user exists and password is correct, false otherwise </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02437">2437</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_ad2f9a31177a8eb0154ec2c998c0e4944_icgraph.png" border="0" usemap="#classCAuthManager_ad2f9a31177a8eb0154ec2c998c0e4944_icgraph" alt=""/></div>
<map name="classCAuthManager_ad2f9a31177a8eb0154ec2c998c0e4944_icgraph" id="classCAuthManager_ad2f9a31177a8eb0154ec2c998c0e4944_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9" title="Authenticate a user, given plain&#45;text password. " alt="" coords="256,5,464,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4746065a8e0f224081de90089986c018"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; uint8_t &gt; CAuthManager::htdigest_hash </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hash a password, htdigest style, using above realm. </p>
<p>Returns array of bytes. htdigest hash is: concatenate username, ':', realm, ':', password, MD5 hash resulting string. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00598">598</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a4746065a8e0f224081de90089986c018_icgraph.png" border="0" usemap="#classCAuthManager_a4746065a8e0f224081de90089986c018_icgraph" alt=""/></div>
<map name="classCAuthManager_a4746065a8e0f224081de90089986c018_icgraph" id="classCAuthManager_a4746065a8e0f224081de90089986c018_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a85b5870678ebb08c84dcf9a1d3cbb6aa" title="Checks if the given string password matches given hash password. " alt="" coords="269,38,456,79"/><area shape="rect" id="node3" href="classCAuthManager.html#ae22812def60fa13bea7e10043180d06b" title="Looks for the given password in the password history of the user. " alt="" coords="531,5,680,46"/><area shape="rect" id="node6" href="classCAuthManager.html#ad2f9a31177a8eb0154ec2c998c0e4944" title="Check a user&#39;s plain text password. " alt="" coords="504,70,707,111"/><area shape="rect" id="node4" href="classCAuthManager.html#a51e0a14d469929e487393244ccd81f46" title="Checks for password policy fulfillment. " alt="" coords="765,5,952,46"/><area shape="rect" id="node5" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="1011,12,1248,39"/><area shape="rect" id="node7" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9" title="Authenticate a user, given plain&#45;text password. " alt="" coords="755,70,963,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a664254c0d548d56db60d3667919100d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CAuthManager::update_passwd_ssh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update /etc/passwd file as necessary for SSH-capable users. </p>
<p>TODO: Currently the password hashes include the original username, case, special characters and all.</p>
<p>Until SSH can authenticate against username-independent hashes, we can't translate usernames into POSIX-compatible equivalents. </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l02175">2175</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a664254c0d548d56db60d3667919100d3_icgraph.png" border="0" usemap="#classCAuthManager_a664254c0d548d56db60d3667919100d3_icgraph" alt=""/></div>
<map name="classCAuthManager_a664254c0d548d56db60d3667919100d3_icgraph" id="classCAuthManager_a664254c0d548d56db60d3667919100d3_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a7fcac3f1bfa72364477eda06ef40217d" title="Constructor. " alt="" coords="225,5,445,32"/><area shape="rect" id="node3" href="classCAuthManager.html#afc45cf6615e81315229a29e4715daab9" title="Set a user&#39;s information, creating it if necessary. " alt="" coords="234,157,435,184"/><area shape="rect" id="node6" href="classCAuthManager.html#a5287651404fc92dfdd61a9e2f56b2bf2" title="Delete a user. " alt="" coords="235,107,434,133"/><area shape="rect" id="node4" href="classCAuthManager.html#aa17ee9691f3b4d97f8367eca32e53e6d" title="Delete a role. " alt="" coords="495,132,691,159"/><area shape="rect" id="node5" href="classCAuthManager.html#a4f8d2b7f588abd875d78c6aad537833a" title="Update or create a role. " alt="" coords="493,195,693,221"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a13eb67d8ef161f4cbb3d693c53ba147a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::canUpdateUser </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>new_role</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if we can update or delete a user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">username,:</td><td>user to be update or delete </td></tr>
    <tr><td class="paramname">new_role,:</td><td>the new role name of the user; null if delete the user; </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if there is at least one security_admin user </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01205">1205</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a13eb67d8ef161f4cbb3d693c53ba147a_icgraph.png" border="0" usemap="#classCAuthManager_a13eb67d8ef161f4cbb3d693c53ba147a_icgraph" alt=""/></div>
<map name="classCAuthManager_a13eb67d8ef161f4cbb3d693c53ba147a_icgraph" id="classCAuthManager_a13eb67d8ef161f4cbb3d693c53ba147a_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#afc45cf6615e81315229a29e4715daab9" title="Set a user&#39;s information, creating it if necessary. " alt="" coords="281,31,482,57"/><area shape="rect" id="node5" href="classCAuthManager.html#a5287651404fc92dfdd61a9e2f56b2bf2" title="Delete a user. " alt="" coords="282,81,481,108"/><area shape="rect" id="node3" href="classCAuthManager.html#aa17ee9691f3b4d97f8367eca32e53e6d" title="Delete a role. " alt="" coords="533,5,729,32"/><area shape="rect" id="node4" href="classCAuthManager.html#a4f8d2b7f588abd875d78c6aad537833a" title="Update or create a role. " alt="" coords="531,56,731,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a822b1830a3adf5907928f1acd0cf56fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::canUpdateRole </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::CBitset&lt; px::permissions &gt; &amp;&#160;</td>
          <td class="paramname"><em>perms</em> = <code>px::CBitset&lt;px::permissions&gt;(&#160;)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if we can update or delete a role. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">role,:</td><td>role name to be update or delete </td></tr>
    <tr><td class="paramname">perms,:</td><td>new permission </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if there is at least one security_admin user </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01265">1265</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a822b1830a3adf5907928f1acd0cf56fb_icgraph.png" border="0" usemap="#classCAuthManager_a822b1830a3adf5907928f1acd0cf56fb_icgraph" alt=""/></div>
<map name="classCAuthManager_a822b1830a3adf5907928f1acd0cf56fb_icgraph" id="classCAuthManager_a822b1830a3adf5907928f1acd0cf56fb_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#aa17ee9691f3b4d97f8367eca32e53e6d" title="Delete a role. " alt="" coords="279,5,475,32"/><area shape="rect" id="node3" href="classCAuthManager.html#a4f8d2b7f588abd875d78c6aad537833a" title="Update or create a role. " alt="" coords="277,56,477,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5aa3485b7f7039265c8a2c746bb89454"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CAuthManager::save_policy </td>
          <td>(</td>
          <td class="paramtype">const px::CUserPolicy &amp;&#160;</td>
          <td class="paramname"><em>policy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saves global password policy to DB. </p>
<p>policy: global password policy </p>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01018">1018</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a5aa3485b7f7039265c8a2c746bb89454_icgraph.png" border="0" usemap="#classCAuthManager_a5aa3485b7f7039265c8a2c746bb89454_icgraph" alt=""/></div>
<map name="classCAuthManager_a5aa3485b7f7039265c8a2c746bb89454_icgraph" id="classCAuthManager_a5aa3485b7f7039265c8a2c746bb89454_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a92a1b2fed6a03e718e437ee9fd6bfa78" title="Set global password Policy information. " alt="" coords="211,5,403,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0b699c18d24e72ee95bb15550a26428b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CAuthManager::update_password_history </td>
          <td>(</td>
          <td class="paramtype">const px::string&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates user password history with the new password. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_id,:</td><td>User Name </td></tr>
    <tr><td class="paramname">hash,:</td><td>New Bcrypt hash </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00819">819</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a0b699c18d24e72ee95bb15550a26428b_icgraph.png" border="0" usemap="#classCAuthManager_a0b699c18d24e72ee95bb15550a26428b_icgraph" alt=""/></div>
<map name="classCAuthManager_a0b699c18d24e72ee95bb15550a26428b_icgraph" id="classCAuthManager_a0b699c18d24e72ee95bb15550a26428b_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="241,5,479,32"/><area shape="rect" id="node3" href="classCAuthManager.html#aaab7a61094a0e9c8c3debfacbe4669ff" title="Set a user&#39;s regular password hash. " alt="" coords="225,56,495,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac43db0fde43b7b643cee28139d9e8128"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CAuthManager::save_password_history </td>
          <td>(</td>
          <td class="paramtype">const px::string&#160;</td>
          <td class="paramname"><em>user_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; uint8_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>pw_history</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Saves the password history for the given user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_name,:</td><td>User Name </td></tr>
    <tr><td class="paramname">password_history,:</td><td>Password History </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00914">914</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_ac43db0fde43b7b643cee28139d9e8128_icgraph.png" border="0" usemap="#classCAuthManager_ac43db0fde43b7b643cee28139d9e8128_icgraph" alt=""/></div>
<map name="classCAuthManager_ac43db0fde43b7b643cee28139d9e8128_icgraph" id="classCAuthManager_ac43db0fde43b7b643cee28139d9e8128_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="228,5,465,32"/><area shape="rect" id="node3" href="classCAuthManager.html#aaab7a61094a0e9c8c3debfacbe4669ff" title="Set a user&#39;s regular password hash. " alt="" coords="211,56,482,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae22812def60fa13bea7e10043180d06b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::find_password </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>user_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>password_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Looks for the given password in the password history of the user. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_name</td><td>- User Name </td></tr>
    <tr><td class="paramname">password</td><td>- New password </td></tr>
    <tr><td class="paramname">password_depth</td><td>- Number of old password to be checked true if password is present within the given depth in history, else false </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00954">954</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_ae22812def60fa13bea7e10043180d06b_icgraph.png" border="0" usemap="#classCAuthManager_ae22812def60fa13bea7e10043180d06b_icgraph" alt=""/></div>
<map name="classCAuthManager_ae22812def60fa13bea7e10043180d06b_icgraph" id="classCAuthManager_ae22812def60fa13bea7e10043180d06b_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#a51e0a14d469929e487393244ccd81f46" title="Checks for password policy fulfillment. " alt="" coords="203,5,389,46"/><area shape="rect" id="node3" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="437,12,675,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85b5870678ebb08c84dcf9a1d3cbb6aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CAuthManager::password_check </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>user_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the given string password matches given hash password. </p>
<p>It matches for bcrypt hash</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_name</td><td>- User name </td></tr>
    <tr><td class="paramname">password</td><td>- Password </td></tr>
    <tr><td class="paramname">hash</td><td>- Password hash (bcrypt) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the password matches with the hash </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l00976">976</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a85b5870678ebb08c84dcf9a1d3cbb6aa_icgraph.png" border="0" usemap="#classCAuthManager_a85b5870678ebb08c84dcf9a1d3cbb6aa_icgraph" alt=""/></div>
<map name="classCAuthManager_a85b5870678ebb08c84dcf9a1d3cbb6aa_icgraph" id="classCAuthManager_a85b5870678ebb08c84dcf9a1d3cbb6aa_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#ae22812def60fa13bea7e10043180d06b" title="Looks for the given password in the password history of the user. " alt="" coords="267,5,416,46"/><area shape="rect" id="node5" href="classCAuthManager.html#ad2f9a31177a8eb0154ec2c998c0e4944" title="Check a user&#39;s plain text password. " alt="" coords="240,70,443,111"/><area shape="rect" id="node3" href="classCAuthManager.html#a51e0a14d469929e487393244ccd81f46" title="Checks for password policy fulfillment. " alt="" coords="501,5,688,46"/><area shape="rect" id="node4" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="747,12,984,39"/><area shape="rect" id="node6" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9" title="Authenticate a user, given plain&#45;text password. " alt="" coords="491,70,699,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a51e0a14d469929e487393244ccd81f46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum px::proto::ChangePasswordStatus CAuthManager::password_policy_check </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks for password policy fulfillment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">username</td><td>- User Name </td></tr>
    <tr><td class="paramname">password</td><td>- Password </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code </dd></dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01389">1389</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a51e0a14d469929e487393244ccd81f46_icgraph.png" border="0" usemap="#classCAuthManager_a51e0a14d469929e487393244ccd81f46_icgraph" alt=""/></div>
<map name="classCAuthManager_a51e0a14d469929e487393244ccd81f46_icgraph" id="classCAuthManager_a51e0a14d469929e487393244ccd81f46_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#ad0acbd206b9b1a3dc330070ba39bd31b" title="Set a user&#39;s plain&#45;text password. " alt="" coords="240,12,477,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a211476e4d4d3093f0330f8c0d34c373e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CAuthManager::migrate_htdigest_to_bcrypt </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>htdigest_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Migrates an htdigest password to bcrypt for UL security requirements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user_name</td><td>- User name </td></tr>
    <tr><td class="paramname">password</td><td>- Password </td></tr>
    <tr><td class="paramname">htdigest_hash</td><td>- Password hash (htdigest) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="auth__manager_8cpp_source.html#l01049">1049</a> of file <a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classCAuthManager_a211476e4d4d3093f0330f8c0d34c373e_icgraph.png" border="0" usemap="#classCAuthManager_a211476e4d4d3093f0330f8c0d34c373e_icgraph" alt=""/></div>
<map name="classCAuthManager_a211476e4d4d3093f0330f8c0d34c373e_icgraph" id="classCAuthManager_a211476e4d4d3093f0330f8c0d34c373e_icgraph">
<area shape="rect" id="node2" href="classCAuthManager.html#ad2f9a31177a8eb0154ec2c998c0e4944" title="Check a user&#39;s plain text password. " alt="" coords="229,5,432,46"/><area shape="rect" id="node3" href="classCAuthManager.html#a402fd33cfc7bc2ae62474c95b079fbf9" title="Authenticate a user, given plain&#45;text password. " alt="" coords="480,5,688,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a353de87a7297243c6a85f5e06467f847"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;px::string, px::CUser&gt; CAuthManager::_users</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Currently defined users Key: user id. </p>
<p>Data: CUser object. </p>

<p>Definition at line <a class="el" href="auth__manager_8hpp_source.html#l00405">405</a> of file <a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="acea1becf9e8f5f4183c79d3b254fbf85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t CAuthManager::_default_strength = 9</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default bcrypt hash strength setting if <a class="el" href="classCAuthManager.html#aa88cec92e7e8f6f8abb585a2edc958c1" title="Set the bcrypt strength parameter for new hashes. ">SetHashStrength()</a> has not been called. </p>
<p>9: 21 hashes/sec on one core of 2.4 GHz Xeon 9: 8 hashes/sec on PXG-900. </p>

<p>Definition at line <a class="el" href="auth__manager_8hpp_source.html#l00487">487</a> of file <a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="afe3040daa7e834c5026c5d578165ee55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint8_t CAuthManager::_default_no_of_pw = 32</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default no. </p>
<p>of passwords to eb stored for each user </p>

<p>Definition at line <a class="el" href="auth__manager_8hpp_source.html#l00492">492</a> of file <a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="auth__manager_8hpp_source.html">auth_manager.hpp</a></li>
<li><a class="el" href="auth__manager_8cpp_source.html">auth_manager.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classCAuthManager.html">CAuthManager</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:24:00 for cds_ng by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
