<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>IoT Agent: FirmwareUpdateManager Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Eaton_Red_Toolbox_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">IoT Agent
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/d13/classFirmwareUpdateManager.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../dd/d63/classFirmwareUpdateManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FirmwareUpdateManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to manage Firmware Updates, largely handling the sequence of states.  
 <a href="../../da/d13/classFirmwareUpdateManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for FirmwareUpdateManager:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d23/classFirmwareUpdateManager__coll__graph.png" border="0" usemap="#FirmwareUpdateManager_coll__map" alt="Collaboration graph"/></div>
<map name="FirmwareUpdateManager_coll__map" id="FirmwareUpdateManager_coll__map">
<area shape="rect" id="node3" title="STL class. " alt="" coords="25,5,153,83"/><area shape="rect" id="node5" title="STL class. " alt="" coords="245,5,373,83"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9282e3d6840aefba21b5c8a8f43b44b7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a> { <br/>
&#160;&#160;<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7a6cf1ad4203d0e75a0fa4fa96ce5ada5c">IDLE</a> = 0, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7ac1e35e1739a3360f6601fbd6c6473eb7">SEND_TRANSFER_IMAGE</a>, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7ac61b5dc5450a12748da8e67d1063143f">RECEIVING_IMAGE</a>, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7a68a9b9aa53690ad6c2f5e0d83029532c">RECEIVE_TIMEOUT</a>, 
<br/>
&#160;&#160;<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7a9231a9c62822ad25dd08773dc4ba5c15">START_IMAGE_UPDATE</a>, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7a3d38ec9834f0fc5bae76e18fa26e9172">DOING_IMAGE_UPDATE</a>, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7ae7491aa4dc8d328909a49d31b43f8409">FINISH_IMAGE_UPDATE</a>, 
<a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7ab0e25ef3a3251ebdc4f37aba2a388dc3">MAX_STATE</a>
<br/>
 }</td></tr>
<tr class="memdesc:a9282e3d6840aefba21b5c8a8f43b44b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set of states for the Firmware Update process.  <a href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">More...</a><br/></td></tr>
<tr class="separator:a9282e3d6840aefba21b5c8a8f43b44b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0e572974f0e94dc43c26c6a468e4c158"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a0e572974f0e94dc43c26c6a468e4c158">FirmwareUpdateManager</a> (std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt; <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ab59f2fb99b64f33e670c2bc99f0ac9eb">iot_core</a>)</td></tr>
<tr class="memdesc:a0e572974f0e94dc43c26c6a468e4c158"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a0e572974f0e94dc43c26c6a468e4c158">More...</a><br/></td></tr>
<tr class="separator:a0e572974f0e94dc43c26c6a468e4c158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a907d7eac95c9d8f9f3de0717203dc25c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a907d7eac95c9d8f9f3de0717203dc25c">~FirmwareUpdateManager</a> ()</td></tr>
<tr class="memdesc:a907d7eac95c9d8f9f3de0717203dc25c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default Xtor.  <a href="#a907d7eac95c9d8f9f3de0717203dc25c">More...</a><br/></td></tr>
<tr class="separator:a907d7eac95c9d8f9f3de0717203dc25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e563e464a8280448287ada172ea6ded"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9e563e464a8280448287ada172ea6ded">request_fw_up_state</a> (enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a> new_state)</td></tr>
<tr class="memdesc:a9e563e464a8280448287ada172ea6ded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request a change to a new Firmware Update state.  <a href="#a9e563e464a8280448287ada172ea6ded">More...</a><br/></td></tr>
<tr class="separator:a9e563e464a8280448287ada172ea6ded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaebdbe472e871dcc3f92b11e1a95a0e8"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#aaebdbe472e871dcc3f92b11e1a95a0e8">get_firmware_update_state</a> ()</td></tr>
<tr class="memdesc:aaebdbe472e871dcc3f92b11e1a95a0e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for the current_state value.  <a href="#aaebdbe472e871dcc3f92b11e1a95a0e8">More...</a><br/></td></tr>
<tr class="separator:aaebdbe472e871dcc3f92b11e1a95a0e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6767cdd86cfe3160ad44b5da69af3ca"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ac6767cdd86cfe3160ad44b5da69af3ca">handle_update_state</a> ()</td></tr>
<tr class="memdesc:ac6767cdd86cfe3160ad44b5da69af3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for the state machine of this class.  <a href="#ac6767cdd86cfe3160ad44b5da69af3ca">More...</a><br/></td></tr>
<tr class="separator:ac6767cdd86cfe3160ad44b5da69af3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc4cf49fc53b53cbd5be76c3b1dc5d0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#acc4cf49fc53b53cbd5be76c3b1dc5d0b">queue_request_image_version_update</a> (px::id_t dev_id)</td></tr>
<tr class="memdesc:acc4cf49fc53b53cbd5be76c3b1dc5d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the given device ID to the request_image_version_list, if it is not already present in this queue.  <a href="#acc4cf49fc53b53cbd5be76c3b1dc5d0b">More...</a><br/></td></tr>
<tr class="separator:acc4cf49fc53b53cbd5be76c3b1dc5d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ab1ea344478f388e60d097b112087364f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ab1ea344478f388e60d097b112087364f">start_firmware_update</a> ()</td></tr>
<tr class="memdesc:ab1ea344478f388e60d097b112087364f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to handle calling our image update app to execute a command line that will be constructed from the current FirmwareUpdate command parameters.  <a href="#ab1ea344478f388e60d097b112087364f">More...</a><br/></td></tr>
<tr class="separator:ab1ea344478f388e60d097b112087364f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65ca579bba272730a195bf4f497963f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ac65ca579bba272730a195bf4f497963f">read_shell_line</a> ()</td></tr>
<tr class="memdesc:ac65ca579bba272730a195bf4f497963f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to read one line of input from the shell that is executing (as for Firmware Update).  <a href="#ac65ca579bba272730a195bf4f497963f">More...</a><br/></td></tr>
<tr class="separator:ac65ca579bba272730a195bf4f497963f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1aee9249f2cdb2fdfc910a68c7b45fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#af1aee9249f2cdb2fdfc910a68c7b45fb">finish_cmd_session</a> ()</td></tr>
<tr class="memdesc:af1aee9249f2cdb2fdfc910a68c7b45fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to close out a Firmware Update shell session and clean up.  <a href="#af1aee9249f2cdb2fdfc910a68c7b45fb">More...</a><br/></td></tr>
<tr class="separator:af1aee9249f2cdb2fdfc910a68c7b45fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ab59f2fb99b64f33e670c2bc99f0ac9eb"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ab59f2fb99b64f33e670c2bc99f0ac9eb">iot_core</a></td></tr>
<tr class="memdesc:ab59f2fb99b64f33e670c2bc99f0ac9eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy of the Core class, which gives us access to the OOB handler and CDS handler, as well as the DeviceClient which holds the map of Devices we support.  <a href="#ab59f2fb99b64f33e670c2bc99f0ac9eb">More...</a><br/></td></tr>
<tr class="separator:ab59f2fb99b64f33e670c2bc99f0ac9eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91f853281c81e6d417fa2c4846707bfa"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a91f853281c81e6d417fa2c4846707bfa">current_state</a></td></tr>
<tr class="memdesc:a91f853281c81e6d417fa2c4846707bfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current state of this Firmware Update manager.  <a href="#a91f853281c81e6d417fa2c4846707bfa">More...</a><br/></td></tr>
<tr class="separator:a91f853281c81e6d417fa2c4846707bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5272163e351e9400f96eca0b83fd4cc4"><td class="memItemLeft" align="right" valign="top">FILE *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a5272163e351e9400f96eca0b83fd4cc4">shell_pipe</a></td></tr>
<tr class="memdesc:a5272163e351e9400f96eca0b83fd4cc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The pipe from popen() when executing a shell command, as for Firmware Update.  <a href="#a5272163e351e9400f96eca0b83fd4cc4">More...</a><br/></td></tr>
<tr class="separator:a5272163e351e9400f96eca0b83fd4cc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f5b4c45e61b481555ad751e3958881"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a86f5b4c45e61b481555ad751e3958881">shell_outlines</a></td></tr>
<tr class="memdesc:a86f5b4c45e61b481555ad751e3958881"><td class="mdescLeft">&#160;</td><td class="mdescRight">The output lines accumulated from the shell which is executing a command, as for Firmware Update.  <a href="#a86f5b4c45e61b481555ad751e3958881">More...</a><br/></td></tr>
<tr class="separator:a86f5b4c45e61b481555ad751e3958881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64dc3cacbd7e9cca011e9c7dca89d94"><td class="memItemLeft" align="right" valign="top">std::deque&lt; px::id_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ad64dc3cacbd7e9cca011e9c7dca89d94">request_image_version_list</a></td></tr>
<tr class="memdesc:ad64dc3cacbd7e9cca011e9c7dca89d94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue of Device IDs awaiting turn to be called to create or update ImageVersion OOB.  <a href="#ad64dc3cacbd7e9cca011e9c7dca89d94">More...</a><br/></td></tr>
<tr class="separator:ad64dc3cacbd7e9cca011e9c7dca89d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac934d942a3e35211f39a709225108875"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ac934d942a3e35211f39a709225108875">timeout_count</a></td></tr>
<tr class="memdesc:ac934d942a3e35211f39a709225108875"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts how many times we enter into the RECEIVE_TIMEOUT or IMAGE_UPDATE_TIMEOUT state.  <a href="#ac934d942a3e35211f39a709225108875">More...</a><br/></td></tr>
<tr class="separator:ac934d942a3e35211f39a709225108875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5086429e3362c7c6142c7be61aad967"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ae5086429e3362c7c6142c7be61aad967">MAX_RECV_TIMEOUT_COUNT</a> = 150</td></tr>
<tr class="memdesc:ae5086429e3362c7c6142c7be61aad967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper limit on how many times we might enter the RECEIVE_TIMEOUT state before we determine that we have failed (timed out) while waiting to receive ImageTransfer messages.  <a href="#ae5086429e3362c7c6142c7be61aad967">More...</a><br/></td></tr>
<tr class="separator:ae5086429e3362c7c6142c7be61aad967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaccd415bd54e74ef0357cf2b942b472"><td class="memItemLeft" align="right" valign="top">const size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#abaccd415bd54e74ef0357cf2b942b472">MAX_IMG_UP_TIMEOUT_COUNT</a> = 6</td></tr>
<tr class="memdesc:abaccd415bd54e74ef0357cf2b942b472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upper limit on how many times we might enter the IMAGE_UPDATE_TIMEOUT state before we determine that we have failed (timed out) while waiting to send DeviceCommandStatus messages.  <a href="#abaccd415bd54e74ef0357cf2b942b472">More...</a><br/></td></tr>
<tr class="separator:abaccd415bd54e74ef0357cf2b942b472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1806412d9882218cc1694558c24fc17"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#ac1806412d9882218cc1694558c24fc17">LINUX_IMAGE_TYPE</a> = &quot;LinuxImage&quot;</td></tr>
<tr class="memdesc:ac1806412d9882218cc1694558c24fc17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the Image type for Linux firmware updates.  <a href="#ac1806412d9882218cc1694558c24fc17">More...</a><br/></td></tr>
<tr class="separator:ac1806412d9882218cc1694558c24fc17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0210e0e31159a36683b5046195f4676a"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a0210e0e31159a36683b5046195f4676a">LINUX_IMAGE_APP_USER</a> = &quot;linux_updater&quot;</td></tr>
<tr class="memdesc:a0210e0e31159a36683b5046195f4676a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the user we will switch to for the update_linux_image app.  <a href="#a0210e0e31159a36683b5046195f4676a">More...</a><br/></td></tr>
<tr class="separator:a0210e0e31159a36683b5046195f4676a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to manage Firmware Updates, largely handling the sequence of states. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00018">18</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">FirmwareUpdateManager::update_states</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set of states for the Firmware Update process. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7a6cf1ad4203d0e75a0fa4fa96ce5ada5c"></a>IDLE</em>&nbsp;</td><td class="fielddoc">
<p>Not doing any firmware update; the default state. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7ac1e35e1739a3360f6601fbd6c6473eb7"></a>SEND_TRANSFER_IMAGE</em>&nbsp;</td><td class="fielddoc">
<p>Send the TransferImage D2C command, after a FirmwareUpdate request. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7ac61b5dc5450a12748da8e67d1063143f"></a>RECEIVING_IMAGE</em>&nbsp;</td><td class="fielddoc">
<p>State while receiving chunks of the image. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7a68a9b9aa53690ad6c2f5e0d83029532c"></a>RECEIVE_TIMEOUT</em>&nbsp;</td><td class="fielddoc">
<p>Conditional state; if not reset to RECEIVING_IMAGE by new ImageTransfer messages, after enough retries will cancel the current Image Update process. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7a9231a9c62822ad25dd08773dc4ba5c15"></a>START_IMAGE_UPDATE</em>&nbsp;</td><td class="fielddoc">
<p>Start the Image Update shell process for the (next) indicated device. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7a3d38ec9834f0fc5bae76e18fa26e9172"></a>DOING_IMAGE_UPDATE</em>&nbsp;</td><td class="fielddoc">
<p>In the state where we read output lines back from the Image Update app until there are no more (EOF). </p>
<p>This paces the Firmware Update process and allows CDS callbacks to be received and send updateDeviceCommandStatus messages during this time. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7ae7491aa4dc8d328909a49d31b43f8409"></a>FINISH_IMAGE_UPDATE</em>&nbsp;</td><td class="fielddoc">
<p>Completes and closes the shell process for one Firmware Update. </p>
<p>If there are more devices, will go back to START_IMAGE_UPDATE. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a9282e3d6840aefba21b5c8a8f43b44b7ab0e25ef3a3251ebdc4f37aba2a388dc3"></a>MAX_STATE</em>&nbsp;</td><td class="fielddoc">
<p>Placeholder for the end of the list. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00027">27</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0e572974f0e94dc43c26c6a468e4c158"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FirmwareUpdateManager::FirmwareUpdateManager </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt;&#160;</td>
          <td class="paramname"><em>iot_core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">iot_core</td><td>The "core" class that manages the ASIO stages and also gives us access to the <a class="el" href="../../dd/d68/classCIotDeviceClient.html" title="Actor that creates a Client IoT Device client and manages its connection to the Azure IoT Hub...">CIotDeviceClient</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00024">24</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a907d7eac95c9d8f9f3de0717203dc25c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FirmwareUpdateManager::~FirmwareUpdateManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default Xtor. </p>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00032">32</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9e563e464a8280448287ada172ea6ded"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FirmwareUpdateManager::request_fw_up_state </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a>&#160;</td>
          <td class="paramname"><em>new_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request a change to a new Firmware Update state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">new_state</td><td>The new state requested. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True on success (OK to request), else False on some issue with the request. </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00037">37</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aaebdbe472e871dcc3f92b11e1a95a0e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">FirmwareUpdateManager::update_states</a> FirmwareUpdateManager::get_firmware_update_state </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Getter for the current_state value. </p>
<dl class="section return"><dt>Returns</dt><dd>The current value of current_state for this class. </dd></dl>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00160">160</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac6767cdd86cfe3160ad44b5da69af3ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool FirmwareUpdateManager::handle_update_state </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for the state machine of this class. </p>
<p>Called periodically by <a class="el" href="../../dd/d68/classCIotDeviceClient.html#ac3e59938659409ee0adee10292047aca" title="Called by the core&#39;s update timer to manage next state / action. ">CIotDeviceClient::handle_timer_update()</a> to give this class a chance to do its work. </p>
<dl class="section return"><dt>Returns</dt><dd>True if the calling function can proceed with normal publishing, else False if it must not publish anything at this time. </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_ac6767cdd86cfe3160ad44b5da69af3ca_cgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_ac6767cdd86cfe3160ad44b5da69af3ca_cgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_ac6767cdd86cfe3160ad44b5da69af3ca_cgraph" id="da/d13/classFirmwareUpdateManager_ac6767cdd86cfe3160ad44b5da69af3ca_cgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ab1ea344478f388e60d097b112087364f" title="Function to handle calling our image update app to execute a command line that will be constructed fr..." alt="" coords="241,5,426,46"/><area shape="rect" id="node3" href="../../da/d13/classFirmwareUpdateManager.html#ac65ca579bba272730a195bf4f497963f" title="Function to read one line of input from the shell that is executing (as for Firmware Update)..." alt="" coords="475,93,661,134"/><area shape="rect" id="node4" href="../../da/d13/classFirmwareUpdateManager.html#af1aee9249f2cdb2fdfc910a68c7b45fb" title="Function to close out a Firmware Update shell session and clean up. " alt="" coords="241,122,426,163"/><area shape="rect" id="node5" href="../../da/d13/classFirmwareUpdateManager.html#acc4cf49fc53b53cbd5be76c3b1dc5d0b" title="Add the given device ID to the request_image_version_list, if it is not already present in this queue..." alt="" coords="241,188,426,244"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acc4cf49fc53b53cbd5be76c3b1dc5d0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FirmwareUpdateManager::queue_request_image_version_update </td>
          <td>(</td>
          <td class="paramtype">px::id_t&#160;</td>
          <td class="paramname"><em>dev_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the given device ID to the request_image_version_list, if it is not already present in this queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dev_id</td><td>The CDS ID of the device to be added. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00429">429</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_acc4cf49fc53b53cbd5be76c3b1dc5d0b_icgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_acc4cf49fc53b53cbd5be76c3b1dc5d0b_icgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_acc4cf49fc53b53cbd5be76c3b1dc5d0b_icgraph" id="da/d13/classFirmwareUpdateManager_acc4cf49fc53b53cbd5be76c3b1dc5d0b_icgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ac6767cdd86cfe3160ad44b5da69af3ca" title="Handler for the state machine of this class. " alt="" coords="241,13,426,54"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab1ea344478f388e60d097b112087364f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FirmwareUpdateManager::start_firmware_update </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to handle calling our image update app to execute a command line that will be constructed from the current FirmwareUpdate command parameters. </p>
<p>Will invoke a shell to start executing the command. Internally, it will set the ext client_state to move to. </p>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00151">151</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_ab1ea344478f388e60d097b112087364f_icgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_ab1ea344478f388e60d097b112087364f_icgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_ab1ea344478f388e60d097b112087364f_icgraph" id="da/d13/classFirmwareUpdateManager_ab1ea344478f388e60d097b112087364f_icgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ac6767cdd86cfe3160ad44b5da69af3ca" title="Handler for the state machine of this class. " alt="" coords="241,5,426,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac65ca579bba272730a195bf4f497963f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool FirmwareUpdateManager::read_shell_line </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to read one line of input from the shell that is executing (as for Firmware Update). </p>
<p>Using fgets(), will hang until it either gets a line or an EOF (or exception). </p>
<dl class="section return"><dt>Returns</dt><dd>True if got a line of input (so there may be more). False if the pipe is not open or reached an EOF. </dd></dl>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00283">283</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_ac65ca579bba272730a195bf4f497963f_icgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_ac65ca579bba272730a195bf4f497963f_icgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_ac65ca579bba272730a195bf4f497963f_icgraph" id="da/d13/classFirmwareUpdateManager_ac65ca579bba272730a195bf4f497963f_icgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ac6767cdd86cfe3160ad44b5da69af3ca" title="Handler for the state machine of this class. " alt="" coords="475,5,661,46"/><area shape="rect" id="node3" href="../../da/d13/classFirmwareUpdateManager.html#af1aee9249f2cdb2fdfc910a68c7b45fb" title="Function to close out a Firmware Update shell session and clean up. " alt="" coords="241,34,426,75"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af1aee9249f2cdb2fdfc910a68c7b45fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FirmwareUpdateManager::finish_cmd_session </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to close out a Firmware Update shell session and clean up. </p>
<p>Pass or fail, it will exit the FirmwareUpdate process if done with all devices, or tee up the next device update if not done with all devices yet. Internally, it will set the appropriate next client_state to move to. </p>

<p>Definition at line <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html#l00320">320</a> of file <a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_cgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_cgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_cgraph" id="da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_cgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ac65ca579bba272730a195bf4f497963f" title="Function to read one line of input from the shell that is executing (as for Firmware Update)..." alt="" coords="241,5,426,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_icgraph.png" border="0" usemap="#da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_icgraph" alt=""/></div>
<map name="da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_icgraph" id="da/d13/classFirmwareUpdateManager_af1aee9249f2cdb2fdfc910a68c7b45fb_icgraph">
<area shape="rect" id="node2" href="../../da/d13/classFirmwareUpdateManager.html#ac6767cdd86cfe3160ad44b5da69af3ca" title="Handler for the state machine of this class. " alt="" coords="241,5,426,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="ab59f2fb99b64f33e670c2bc99f0ac9eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a>&gt; FirmwareUpdateManager::iot_core</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy of the Core class, which gives us access to the OOB handler and CDS handler, as well as the DeviceClient which holds the map of Devices we support. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00116">116</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a91f853281c81e6d417fa2c4846707bfa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7">update_states</a> FirmwareUpdateManager::current_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The current state of this Firmware Update manager. </p>
<p>Set to one of the states in the set above. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00120">120</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5272163e351e9400f96eca0b83fd4cc4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FILE* FirmwareUpdateManager::shell_pipe</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The pipe from popen() when executing a shell command, as for Firmware Update. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00123">123</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a86f5b4c45e61b481555ad751e3958881"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; FirmwareUpdateManager::shell_outlines</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The output lines accumulated from the shell which is executing a command, as for Firmware Update. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00127">127</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad64dc3cacbd7e9cca011e9c7dca89d94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::deque&lt;px::id_t&gt; FirmwareUpdateManager::request_image_version_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queue of Device IDs awaiting turn to be called to create or update ImageVersion OOB. </p>
<p>Turns out that deque was the most useful queue type to use: fast and suitable, with pop_front and push_back() functions (but no find() ). </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00133">133</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac934d942a3e35211f39a709225108875"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t FirmwareUpdateManager::timeout_count</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Counts how many times we enter into the RECEIVE_TIMEOUT or IMAGE_UPDATE_TIMEOUT state. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00136">136</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae5086429e3362c7c6142c7be61aad967"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t FirmwareUpdateManager::MAX_RECV_TIMEOUT_COUNT = 150</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upper limit on how many times we might enter the RECEIVE_TIMEOUT state before we determine that we have failed (timed out) while waiting to receive ImageTransfer messages. </p>
<p>15s proved insufficient. So going for 150s; should be enough delay for PX White to make 2 retries. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00144">144</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="abaccd415bd54e74ef0357cf2b942b472"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const size_t FirmwareUpdateManager::MAX_IMG_UP_TIMEOUT_COUNT = 6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Upper limit on how many times we might enter the IMAGE_UPDATE_TIMEOUT state before we determine that we have failed (timed out) while waiting to send DeviceCommandStatus messages. </p>
<p>6x gives us about 30s of buffer, which seems reasonable. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00151">151</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac1806412d9882218cc1694558c24fc17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* FirmwareUpdateManager::LINUX_IMAGE_TYPE = &quot;LinuxImage&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of the Image type for Linux firmware updates. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00154">154</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0210e0e31159a36683b5046195f4676a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* FirmwareUpdateManager::LINUX_IMAGE_APP_USER = &quot;linux_updater&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Name of the user we will switch to for the update_linux_image app. </p>

<p>Definition at line <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html#l00157">157</a> of file <a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/src/product-ref1/px-toolkit/etn_source/iot_agent/include/<a class="el" href="../../db/d5b/firmware__update__manager_8hpp_source.html">firmware_update_manager.hpp</a></li>
<li>/src/product-ref1/px-toolkit/etn_source/iot_agent/source/<a class="el" href="../../d3/d6a/firmware__update__manager_8cpp_source.html">firmware_update_manager.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/d13/classFirmwareUpdateManager.html">FirmwareUpdateManager</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:26:03 for IoT Agent by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
