<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>IoT Agent: CNetDiag Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Eaton_Red_Toolbox_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">IoT Agent
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('da/d95/classCNetDiag.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../de/dbd/classCNetDiag-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CNetDiag Class Reference<div class="ingroups"><a class="el" href="../../d1/dca/group__iot__net__diagnostics.html">Net Diagnostics</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The class to diagnose and report on connection issues.  
 <a href="../../da/d95/classCNetDiag.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for CNetDiag:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d8f/classCNetDiag__coll__graph.png" border="0" usemap="#CNetDiag_coll__map" alt="Collaboration graph"/></div>
<map name="CNetDiag_coll__map" id="CNetDiag_coll__map">
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa3e8c680c9071fa430c8c71581818599"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#aa3e8c680c9071fa430c8c71581818599">CNetDiag</a> (std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt; core)</td></tr>
<tr class="memdesc:aa3e8c680c9071fa430c8c71581818599"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public Member Functions.  <a href="#aa3e8c680c9071fa430c8c71581818599">More...</a><br/></td></tr>
<tr class="separator:aa3e8c680c9071fa430c8c71581818599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c5f5c045c4ae13f3daa36d0fa54f555"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a2c5f5c045c4ae13f3daa36d0fa54f555">~CNetDiag</a> ()</td></tr>
<tr class="memdesc:a2c5f5c045c4ae13f3daa36d0fa54f555"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a2c5f5c045c4ae13f3daa36d0fa54f555">More...</a><br/></td></tr>
<tr class="separator:a2c5f5c045c4ae13f3daa36d0fa54f555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga65f7c89848b60a66b4a52a9d941e2546"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d68/classCIotDeviceClient.html#a57d4e9607606f259a2a1e857e7710f08">CIotDeviceClient::client_states</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546">launch_net_diagnostics</a> ()</td></tr>
<tr class="memdesc:ga65f7c89848b60a66b4a52a9d941e2546"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launches the task that runs the net diagnostics tests.  <a href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546">More...</a><br/></td></tr>
<tr class="separator:ga65f7c89848b60a66b4a52a9d941e2546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15e7df276155c438a80e8b52aa6932ce"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a15e7df276155c438a80e8b52aa6932ce">check_is_done</a> ()</td></tr>
<tr class="memdesc:a15e7df276155c438a80e8b52aa6932ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility to check to see if the Diagnostic task (thread) is done.  <a href="#a15e7df276155c438a80e8b52aa6932ce">More...</a><br/></td></tr>
<tr class="separator:a15e7df276155c438a80e8b52aa6932ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83030eb10775274263fc231ffcf4c231"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a83030eb10775274263fc231ffcf4c231">get_results</a> ()</td></tr>
<tr class="memdesc:a83030eb10775274263fc231ffcf4c231"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the results of the diagnostics thread, once it is done executing.  <a href="#a83030eb10775274263fc231ffcf4c231">More...</a><br/></td></tr>
<tr class="separator:a83030eb10775274263fc231ffcf4c231"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4dada36a18e2239c573bc8296a3f68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a3e4dada36a18e2239c573bc8296a3f68">request_thread_stop</a> ()</td></tr>
<tr class="memdesc:a3e4dada36a18e2239c573bc8296a3f68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility that lets the calling application request the running diagnostics thread to stop.  <a href="#a3e4dada36a18e2239c573bc8296a3f68">More...</a><br/></td></tr>
<tr class="separator:a3e4dada36a18e2239c573bc8296a3f68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3e5a05033292d428ee7f99a80c5a48ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca">net_diag_tests</a> ()</td></tr>
<tr class="memdesc:a3e5a05033292d428ee7f99a80c5a48ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protected Member Functions Using Protected instead of Private to permit unit test access.  <a href="#a3e5a05033292d428ee7f99a80c5a48ca">More...</a><br/></td></tr>
<tr class="separator:a3e5a05033292d428ee7f99a80c5a48ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1fbe9c7a71248208d53e73135ae81ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#ac1fbe9c7a71248208d53e73135ae81ed">dns_test</a> ()</td></tr>
<tr class="memdesc:ac1fbe9c7a71248208d53e73135ae81ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test DNS lookup, and store the resolved IP addresses for the target, proxy, and www.eaton.com.  <a href="#ac1fbe9c7a71248208d53e73135ae81ed">More...</a><br/></td></tr>
<tr class="separator:ac1fbe9c7a71248208d53e73135ae81ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4563e04e6657c0202af3e57551cad688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a4563e04e6657c0202af3e57551cad688">proxy_test</a> ()</td></tr>
<tr class="memdesc:a4563e04e6657c0202af3e57551cad688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test proxy, and connecting to www.eaton.com/robots.txt via the proxy.  <a href="#a4563e04e6657c0202af3e57551cad688">More...</a><br/></td></tr>
<tr class="separator:a4563e04e6657c0202af3e57551cad688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6a1f28821ef0e34cf1fe915a5d8be7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#acf6a1f28821ef0e34cf1fe915a5d8be7">inet_test</a> ()</td></tr>
<tr class="memdesc:acf6a1f28821ef0e34cf1fe915a5d8be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test Internet connectivity (directly to www.eaton.com, ports 80 and 443).  <a href="#acf6a1f28821ef0e34cf1fe915a5d8be7">More...</a><br/></td></tr>
<tr class="separator:acf6a1f28821ef0e34cf1fe915a5d8be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c7ba59accaf7315ed572d0b321065b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#aa2c7ba59accaf7315ed572d0b321065b">host_test</a> ()</td></tr>
<tr class="memdesc:aa2c7ba59accaf7315ed572d0b321065b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test connectivity to the configured host endpoint.  <a href="#aa2c7ba59accaf7315ed572d0b321065b">More...</a><br/></td></tr>
<tr class="separator:aa2c7ba59accaf7315ed572d0b321065b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b5be54c4c74f6cea5505c72b050f44"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#ac5b5be54c4c74f6cea5505c72b050f44">ping_test</a> ()</td></tr>
<tr class="memdesc:ac5b5be54c4c74f6cea5505c72b050f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test the configured host endpoint responds.  <a href="#ac5b5be54c4c74f6cea5505c72b050f44">More...</a><br/></td></tr>
<tr class="separator:ac5b5be54c4c74f6cea5505c72b050f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5d4dafd0835af7be4a783717075bd54"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#aa5d4dafd0835af7be4a783717075bd54">try_tcp</a> (const px::string &amp;ip, uint16_t port)</td></tr>
<tr class="memdesc:aa5d4dafd0835af7be4a783717075bd54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try a TCP connection to the specified numeric address and port.  <a href="#aa5d4dafd0835af7be4a783717075bd54">More...</a><br/></td></tr>
<tr class="separator:aa5d4dafd0835af7be4a783717075bd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64f87342fba0950929e4006bbca858ca"><td class="memItemLeft" align="right" valign="top">CURLcode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a64f87342fba0950929e4006bbca858ca">curl_with_proxy_test</a> (const char *target_url, const char *fname, bool is_https, bool no_proxy, const char *exp_text)</td></tr>
<tr class="memdesc:a64f87342fba0950929e4006bbca858ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to get the given URL and file, and see if the expected response is returned.  <a href="#a64f87342fba0950929e4006bbca858ca">More...</a><br/></td></tr>
<tr class="separator:a64f87342fba0950929e4006bbca858ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a669b2b955957f9afec1072908ac28299"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a669b2b955957f9afec1072908ac28299">_core</a></td></tr>
<tr class="memdesc:a669b2b955957f9afec1072908ac28299"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protected Data Members.  <a href="#a669b2b955957f9afec1072908ac28299">More...</a><br/></td></tr>
<tr class="separator:a669b2b955957f9afec1072908ac28299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a86f6405e11efa198c4ff85f34d21cf"><td class="memItemLeft" align="right" valign="top">px::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a0a86f6405e11efa198c4ff85f34d21cf">_eaton_com_ip</a></td></tr>
<tr class="memdesc:a0a86f6405e11efa198c4ff85f34d21cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP address of www.eaton.com, determined via DNS lookup.  <a href="#a0a86f6405e11efa198c4ff85f34d21cf">More...</a><br/></td></tr>
<tr class="separator:a0a86f6405e11efa198c4ff85f34d21cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482f36c3342ec8d7cf60f637e56d9bea"><td class="memItemLeft" align="right" valign="top">px::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a482f36c3342ec8d7cf60f637e56d9bea">_host_ip</a></td></tr>
<tr class="memdesc:a482f36c3342ec8d7cf60f637e56d9bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP address of the target, determined via DNS lookup.  <a href="#a482f36c3342ec8d7cf60f637e56d9bea">More...</a><br/></td></tr>
<tr class="separator:a482f36c3342ec8d7cf60f637e56d9bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f433a03b8973fb96caf6808f2992a3c"><td class="memItemLeft" align="right" valign="top">px::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a0f433a03b8973fb96caf6808f2992a3c">_proxy_ip</a></td></tr>
<tr class="memdesc:a0f433a03b8973fb96caf6808f2992a3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP address of the proxy, determined via DNS lookup.  <a href="#a0f433a03b8973fb96caf6808f2992a3c">More...</a><br/></td></tr>
<tr class="separator:a0f433a03b8973fb96caf6808f2992a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a06fcd0a47c828037c8bd9e2e2126865c"><td class="memItemLeft" align="right" valign="top">std::future&lt; <a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a06fcd0a47c828037c8bd9e2e2126865c">netdiag_future_result</a></td></tr>
<tr class="memdesc:a06fcd0a47c828037c8bd9e2e2126865c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Private Data Members.  <a href="#a06fcd0a47c828037c8bd9e2e2126865c">More...</a><br/></td></tr>
<tr class="separator:a06fcd0a47c828037c8bd9e2e2126865c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd8557b67e8ab75f64227f7e40d1bdf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a4dd8557b67e8ab75f64227f7e40d1bdf">want_thread_stop</a></td></tr>
<tr class="memdesc:a4dd8557b67e8ab75f64227f7e40d1bdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The flag that tells our diagnostic task to stop and exit the thread, with the preliminary results.  <a href="#a4dd8557b67e8ab75f64227f7e40d1bdf">More...</a><br/></td></tr>
<tr class="separator:a4dd8557b67e8ab75f64227f7e40d1bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00dfe20bd1076fb4590790a86a29d277"><td class="memItemLeft" align="right" valign="top">const time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d95/classCNetDiag.html#a00dfe20bd1076fb4590790a86a29d277">CONNECT_TIMEOUT_SECS</a> = 30</td></tr>
<tr class="memdesc:a00dfe20bd1076fb4590790a86a29d277"><td class="mdescLeft">&#160;</td><td class="mdescRight">The timeout value to use when testing connections Tests in-house (CPO, crappy network) with curl showed response delay of ~8s for en.cppreference.com, so use overly generous 30s.  <a href="#a00dfe20bd1076fb4590790a86a29d277">More...</a><br/></td></tr>
<tr class="separator:a00dfe20bd1076fb4590790a86a29d277"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The class to diagnose and report on connection issues. </p>
<p>When the connection to Azure fails or fails to connect, this class' methods are invoked to try to determine and inform the user about the reason for the failure. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00024">24</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa3e8c680c9071fa430c8c71581818599"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CNetDiag::CNetDiag </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt;&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public Member Functions. </p>
<p>Constructor</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">core</td><td>CServerCore pointer, to access config </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00175">175</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2c5f5c045c4ae13f3daa36d0fa54f555"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CNetDiag::~CNetDiag </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>
<p>Frees resources. Stops tests in progress, if feasible. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00184">184</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a15e7df276155c438a80e8b52aa6932ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool CNetDiag::check_is_done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility to check to see if the Diagnostic task (thread) is done. </p>
<p>You should not call <a class="el" href="../../da/d95/classCNetDiag.html#a83030eb10775274263fc231ffcf4c231" title="Get the results of the diagnostics thread, once it is done executing. ">get_results()</a> until this returns True, or your main thread will stop and wait on this thread being done.</p>
<dl class="section return"><dt>Returns</dt><dd>True when done, else False. </dd></dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00230">230</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a15e7df276155c438a80e8b52aa6932ce_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_a15e7df276155c438a80e8b52aa6932ce_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a15e7df276155c438a80e8b52aa6932ce_icgraph" id="da/d95/classCNetDiag_a15e7df276155c438a80e8b52aa6932ce_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a83030eb10775274263fc231ffcf4c231" title="Get the results of the diagnostics thread, once it is done executing. " alt="" coords="241,5,405,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a83030eb10775274263fc231ffcf4c231"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::get_results </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the results of the diagnostics thread, once it is done executing. </p>
<p>Use <a class="el" href="../../da/d95/classCNetDiag.html#a15e7df276155c438a80e8b52aa6932ce" title="Utility to check to see if the Diagnostic task (thread) is done. ">check_is_done()</a> first to ensure that the thread has completed, or this call will make the calling thread wait on this thread's completion. Returns unknown/empty-string if all tests pass, but we expect to be called only upon connection failure.</p>
<dl class="section return"><dt>Returns</dt><dd>Tuple containing an Error code as in IotAgentSettings.proto, a human-readable error message (empty if there is no error found), and a bool which is True if the error is "fatal" (meaning that we should exit the iot_agent and wait until the user fixes something). </dd></dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00260">260</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a83030eb10775274263fc231ffcf4c231_cgraph.png" border="0" usemap="#da/d95/classCNetDiag_a83030eb10775274263fc231ffcf4c231_cgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a83030eb10775274263fc231ffcf4c231_cgraph" id="da/d95/classCNetDiag_a83030eb10775274263fc231ffcf4c231_cgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a15e7df276155c438a80e8b52aa6932ce" title="Utility to check to see if the Diagnostic task (thread) is done. " alt="" coords="219,5,405,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e4dada36a18e2239c573bc8296a3f68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CNetDiag::request_thread_stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility that lets the calling application request the running diagnostics thread to stop. </p>
<p>No guarantee of success, and no timeout included here - just best effort. Normally this would only be called on shutdown. The application can then use <a class="el" href="../../da/d95/classCNetDiag.html#a15e7df276155c438a80e8b52aa6932ce" title="Utility to check to see if the Diagnostic task (thread) is done. ">check_is_done()</a> to see if the thread exited, or wait on <a class="el" href="../../da/d95/classCNetDiag.html#a83030eb10775274263fc231ffcf4c231" title="Get the results of the diagnostics thread, once it is done executing. ">get_results()</a> if it is willing to wait. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00288">288</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3e5a05033292d428ee7f99a80c5a48ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::net_diag_tests </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protected Member Functions Using Protected instead of Private to permit unit test access. </p>
<p>This is the task that runs a series of diagnostic tests. <a class="el" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. ">launch_net_diagnostics()</a> will run this task in a separate thread. Eventually returns an error code, and sets the provided string to a useful message. Returns unknown/empty-string if all tests pass (we expect to be called only upon connection failure).</p>
<dl class="section return"><dt>Returns</dt><dd>Tuple containing an Error code as in IotAgentSettings.proto, a human-readable error message (empty if there is no error found), and a bool which is True if the error is "fatal" (meaning that we should exit the iot_agent and wait until the user fixes something). </dd></dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00306">306</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_cgraph.png" border="0" usemap="#da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_cgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_cgraph" id="da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_cgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#ac1fbe9c7a71248208d53e73135ae81ed" title="Test DNS lookup, and store the resolved IP addresses for the target, proxy, and www.eaton.com. " alt="" coords="211,5,357,32"/><area shape="rect" id="node3" href="../../da/d95/classCNetDiag.html#a4563e04e6657c0202af3e57551cad688" title="Test proxy, and connecting to www.eaton.com/robots.txt via the proxy. " alt="" coords="203,157,365,184"/><area shape="rect" id="node6" href="../../da/d95/classCNetDiag.html#acf6a1f28821ef0e34cf1fe915a5d8be7" title="Test Internet connectivity (directly to www.eaton.com, ports 80 and 443). " alt="" coords="209,56,359,83"/><area shape="rect" id="node7" href="../../da/d95/classCNetDiag.html#aa2c7ba59accaf7315ed572d0b321065b" title="Test connectivity to the configured host endpoint. " alt="" coords="208,107,360,133"/><area shape="rect" id="node8" href="../../da/d95/classCNetDiag.html#ac5b5be54c4c74f6cea5505c72b050f44" title="Test the configured host endpoint responds. " alt="" coords="208,208,360,235"/><area shape="rect" id="node4" href="../../da/d95/classCNetDiag.html#aa5d4dafd0835af7be4a783717075bd54" title="Try a TCP connection to the specified numeric address and port. " alt="" coords="421,99,558,125"/><area shape="rect" id="node5" href="../../da/d95/classCNetDiag.html#a64f87342fba0950929e4006bbca858ca" title="Try to get the given URL and file, and see if the expected response is returned. " alt="" coords="414,150,565,191"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_icgraph" id="da/d95/classCNetDiag_a3e5a05033292d428ee7f99a80c5a48ca_icgraph">
<area shape="rect" id="node2" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="203,5,365,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac1fbe9c7a71248208d53e73135ae81ed"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::dns_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test DNS lookup, and store the resolved IP addresses for the target, proxy, and www.eaton.com. </p>
<p>Returns IOT_NO_ERROR if no error found, or appropriate error and message if error found. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00380">380</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_ac1fbe9c7a71248208d53e73135ae81ed_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_ac1fbe9c7a71248208d53e73135ae81ed_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_ac1fbe9c7a71248208d53e73135ae81ed_icgraph" id="da/d95/classCNetDiag_ac1fbe9c7a71248208d53e73135ae81ed_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="201,5,349,46"/><area shape="rect" id="node3" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="397,5,560,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4563e04e6657c0202af3e57551cad688"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::proxy_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test proxy, and connecting to www.eaton.com/robots.txt via the proxy. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00548">548</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_cgraph.png" border="0" usemap="#da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_cgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_cgraph" id="da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_cgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#aa5d4dafd0835af7be4a783717075bd54" title="Try a TCP connection to the specified numeric address and port. " alt="" coords="223,5,361,32"/><area shape="rect" id="node3" href="../../da/d95/classCNetDiag.html#a64f87342fba0950929e4006bbca858ca" title="Try to get the given URL and file, and see if the expected response is returned. " alt="" coords="217,57,367,98"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_icgraph" id="da/d95/classCNetDiag_a4563e04e6657c0202af3e57551cad688_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="217,5,365,46"/><area shape="rect" id="node3" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="413,5,576,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf6a1f28821ef0e34cf1fe915a5d8be7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::inet_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test Internet connectivity (directly to www.eaton.com, ports 80 and 443). </p>
<p>Do not try this if the proxy is required. Since we have previously shown that DNS lookup is working, we can presume that we have an internet connection, so that failure here means that proxy settings are needed. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00607">607</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_cgraph.png" border="0" usemap="#da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_cgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_cgraph" id="da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_cgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#aa5d4dafd0835af7be4a783717075bd54" title="Try a TCP connection to the specified numeric address and port. " alt="" coords="203,5,341,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_icgraph" id="da/d95/classCNetDiag_acf6a1f28821ef0e34cf1fe915a5d8be7_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="203,5,351,46"/><area shape="rect" id="node3" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="400,5,563,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa2c7ba59accaf7315ed572d0b321065b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::host_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test connectivity to the configured host endpoint. </p>
<p>Will use a direct TCP connection if there is not proxy, else will use curl with proxy option to try to reach the host. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00638">638</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_cgraph.png" border="0" usemap="#da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_cgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_cgraph" id="da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_cgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#aa5d4dafd0835af7be4a783717075bd54" title="Try a TCP connection to the specified numeric address and port. " alt="" coords="213,5,350,32"/><area shape="rect" id="node3" href="../../da/d95/classCNetDiag.html#a64f87342fba0950929e4006bbca858ca" title="Try to get the given URL and file, and see if the expected response is returned. " alt="" coords="206,57,357,98"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_icgraph" id="da/d95/classCNetDiag_aa2c7ba59accaf7315ed572d0b321065b_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="206,5,354,46"/><area shape="rect" id="node3" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="403,5,565,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac5b5be54c4c74f6cea5505c72b050f44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a> CNetDiag::ping_test </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test the configured host endpoint responds. </p>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00682">682</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_ac5b5be54c4c74f6cea5505c72b050f44_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_ac5b5be54c4c74f6cea5505c72b050f44_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_ac5b5be54c4c74f6cea5505c72b050f44_icgraph" id="da/d95/classCNetDiag_ac5b5be54c4c74f6cea5505c72b050f44_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="206,5,354,46"/><area shape="rect" id="node3" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="403,5,565,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa5d4dafd0835af7be4a783717075bd54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CNetDiag::try_tcp </td>
          <td>(</td>
          <td class="paramtype">const px::string &amp;&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try a TCP connection to the specified numeric address and port. </p>
<p>Drops the connection without sending anything. Will not succeed if the proxy is necessary to reach this endpoint.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ip</td><td>Numeric IP address in string form</td></tr>
    <tr><td class="paramname">port</td><td>TCP port to connect to</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if connection succeeded, false if not In case of success, returns almost immediately; in case of failure, can delay for a long time (&gt;15s) </dd></dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00095">95</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_aa5d4dafd0835af7be4a783717075bd54_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_aa5d4dafd0835af7be4a783717075bd54_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_aa5d4dafd0835af7be4a783717075bd54_icgraph" id="da/d95/classCNetDiag_aa5d4dafd0835af7be4a783717075bd54_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a4563e04e6657c0202af3e57551cad688" title="Test proxy, and connecting to www.eaton.com/robots.txt via the proxy. " alt="" coords="193,5,354,32"/><area shape="rect" id="node5" href="../../da/d95/classCNetDiag.html#acf6a1f28821ef0e34cf1fe915a5d8be7" title="Test Internet connectivity (directly to www.eaton.com, ports 80 and 443). " alt="" coords="199,56,348,83"/><area shape="rect" id="node6" href="../../da/d95/classCNetDiag.html#aa2c7ba59accaf7315ed572d0b321065b" title="Test connectivity to the configured host endpoint. " alt="" coords="197,107,349,133"/><area shape="rect" id="node3" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="403,49,551,90"/><area shape="rect" id="node4" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="600,49,763,90"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a64f87342fba0950929e4006bbca858ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CURLcode CNetDiag::curl_with_proxy_test </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>target_url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_https</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>no_proxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>exp_text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Try to get the given URL and file, and see if the expected response is returned. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target_url</td><td>The URL of the target (less the filename portion). </td></tr>
    <tr><td class="paramname">fname</td><td>The filename to be appended to the URL for the request. </td></tr>
    <tr><td class="paramname">is_https</td><td>Set True if this should be an HTTPS request, else False for HTTP. </td></tr>
    <tr><td class="paramname">exp_text</td><td>The beginning of the text that will be received on success. </td></tr>
    <tr><td class="paramname">no_proxy</td><td>But sometimes we want to run this without using a proxy; set this True in those cases. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CURLE_OK on success, else one of the Curl error codes </dd></dl>

<p>Definition at line <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html#l00438">438</a> of file <a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d95/classCNetDiag_a64f87342fba0950929e4006bbca858ca_icgraph.png" border="0" usemap="#da/d95/classCNetDiag_a64f87342fba0950929e4006bbca858ca_icgraph" alt=""/></div>
<map name="da/d95/classCNetDiag_a64f87342fba0950929e4006bbca858ca_icgraph" id="da/d95/classCNetDiag_a64f87342fba0950929e4006bbca858ca_icgraph">
<area shape="rect" id="node2" href="../../da/d95/classCNetDiag.html#a4563e04e6657c0202af3e57551cad688" title="Test proxy, and connecting to www.eaton.com/robots.txt via the proxy. " alt="" coords="206,5,367,32"/><area shape="rect" id="node5" href="../../da/d95/classCNetDiag.html#aa2c7ba59accaf7315ed572d0b321065b" title="Test connectivity to the configured host endpoint. " alt="" coords="211,56,363,83"/><area shape="rect" id="node3" href="../../da/d95/classCNetDiag.html#a3e5a05033292d428ee7f99a80c5a48ca" title="Protected Member Functions Using Protected instead of Private to permit unit test access..." alt="" coords="417,23,565,65"/><area shape="rect" id="node4" href="../../d3/dbd/group__iot__threading.html#ga65f7c89848b60a66b4a52a9d941e2546" title="Launches the task that runs the net diagnostics tests. " alt="" coords="613,23,776,65"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a669b2b955957f9afec1072908ac28299"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a>&gt; CNetDiag::_core</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protected Data Members. </p>
<p>Server core object for the application. Include pointer to the OOB handler which holds the IoT connection and proxy settings. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00182">182</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0a86f6405e11efa198c4ff85f34d21cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">px::string CNetDiag::_eaton_com_ip</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>IP address of www.eaton.com, determined via DNS lookup. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00187">187</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a482f36c3342ec8d7cf60f637e56d9bea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">px::string CNetDiag::_host_ip</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>IP address of the target, determined via DNS lookup. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00192">192</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0f433a03b8973fb96caf6808f2992a3c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">px::string CNetDiag::_proxy_ip</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>IP address of the proxy, determined via DNS lookup. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00197">197</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a06fcd0a47c828037c8bd9e2e2126865c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::future&lt;<a class="el" href="../../d9/d6d/netdiag_8hpp.html#af7748fac70c737db122be529be514575">netdiag_test_result</a>&gt; CNetDiag::netdiag_future_result</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Private Data Members. </p>
<p>The future that our thread will provide on exit. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00213">213</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4dd8557b67e8ab75f64227f7e40d1bdf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CNetDiag::want_thread_stop</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The flag that tells our diagnostic task to stop and exit the thread, with the preliminary results. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00219">219</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a00dfe20bd1076fb4590790a86a29d277"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const time_t CNetDiag::CONNECT_TIMEOUT_SECS = 30</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The timeout value to use when testing connections Tests in-house (CPO, crappy network) with curl showed response delay of ~8s for en.cppreference.com, so use overly generous 30s. </p>

<p>Definition at line <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html#l00225">225</a> of file <a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/src/product-ref1/px-toolkit/etn_source/iot_agent/include/<a class="el" href="../../d9/d6d/netdiag_8hpp_source.html">netdiag.hpp</a></li>
<li>/src/product-ref1/px-toolkit/etn_source/iot_agent/source/<a class="el" href="../../d9/ddb/netdiag_8cpp_source.html">netdiag.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../da/d95/classCNetDiag.html">CNetDiag</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:26:03 for IoT Agent by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
