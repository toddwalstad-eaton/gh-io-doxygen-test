<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>IoT Agent: Firmware Update via the IoT Agent</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Eaton_Red_Toolbox_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">IoT Agent
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d9/d62/md__src_product-ref1_px-toolkit_etn_source_iot_agent_docs_iot_firmware_update.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Firmware Update via the IoT Agent </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>PX White DLM (Device Lifecycle Management)</h2>
<p>The Firmware Update operations are described in PX White confluence pages, eg <a href="http://cipt0534.nam.ci.root:8090/display/IoTPlatform/Q3+2017+DLM+Service">Q3 2017 DLM Service</a> and the <a href="https://confluence-prod.tcc.etn.com/display/IoTPlatform/Firmware+Update">"Latest" Firmware Update</a>. Particularly important to review there is the sequence of operations, as this shows the background for the <a class="el" href="../../da/d13/classFirmwareUpdateManager.html#a9282e3d6840aefba21b5c8a8f43b44b7" title="Set of states for the Firmware Update process. ">FirmwareUpdateManager::update_states</a>.</p>
<h2>How To push a firmware image as a "blob" to PX White</h2>
<p>See "[How To Upload Firmware Image as "blob" to PX White](https://confluence-prod.tcc.etn.com/pages/viewpage.action?pageId=113396887)".</p>
<h2>Normal Sequence of Firmware Update states</h2>
<p>The normal process of a LinuxImage firmware update follows the flow shown in this image </p>
<div class="image">
<img src="https://confluence-prod.tcc.etn.com/download/attachments/21400576/FirmwareUpdateManager_update_states_flow.png"  alt="FirmwareUpdateManager_update_states"/>
</div>
<p> (from <a href="https://confluence-prod.tcc.etn.com/display/LNXTK/IoT+%3A+Firmware+upgrade+from+PX+White#IoT:FirmwareupgradefromPXWhite-SequenceofstatesintheIoTAgentforFirmwareUpdate">this design page</a>).</p>
<h2>Product-specific topics, for Device-oriented firmware update</h2>
<p>The iot_agent supports products that want to manage firmware update for their non-gateway devices.</p>
<p>The <a href="../../../iot_agent_oobs.md">IoT OOB Descriptions</a> cover all of the OOBs that are necessary, and that are mentioned in this section.</p>
<h3>Product-specific Image Update App(s)</h3>
<p>The critical piece of product-specific Firmware Update is that the product must supply one or more Image Update apps to handle the three "actions" for firmware updating: "make_version_oob", "check_version", and "update", using the API described in <a href="../../../update_linux_image/include/update_linux_image.h">update_linux_image.h</a> for all Image Update apps (of which the program that updates the gateway's LinuxImage is just one example).</p>
<h3>Product-specific ImageVersion OOBs</h3>
<p>The product-specific Firmware Update app must generate the ImageVersion/product/type/version OOB(s) for the supported devices.</p>
<p>The way a product tells the iot_agent which device models have Firmware Update support, and which app to use for the model, is by one or more mageUpdateApp/product OOB(s). These OOB(s) provide a simple mapping from canonical device model to the specific Image Update app name.</p>
<h3>Using a gateway-based Image Update app for multiple devices</h3>
<p>Sometimes it is convenient to address more than one device for Firmware Updates, especially when the number of such devices attached to a gateway is so big that updating them individually from PX White would be objectionable. Another example of this is when the gateway is capable of doing parallel updates of its devices.</p>
<p>The solution to this is to direct the Firmware Update command from PX White to gateway itself, but with an image type different than LinuxImage. To make this work, the product must add an ImageVersion OOB that maps the gateway device, device Image Type, and device Image Update app name together, so the iot_agent can address the correct Image Update app when it gets a Firmware Update command for the device Image Type. See the example <a href="https://bitbucket-prod.tcc.etn.com/projects/LNXTK/repos/product-test/browse/rootfs/etc/cds/platform/82_parallel_update_image.json">ImageVersion/PX-Red-KVM/Parallel_Image/AnyVersion</a> in the product-test code; the most important parts to specify are "image_name" and "image_update_app" fields.</p>
<p>There is some test code to exercise this in a product_test build in <a href="../../../source/test/test__fw_update.cpp">test__fw_update.cpp</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 7 2021 20:26:03 for IoT Agent by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
