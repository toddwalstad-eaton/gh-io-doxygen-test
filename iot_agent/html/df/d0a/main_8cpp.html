<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>IoT Agent: /src/product-ref1/px-toolkit/etn_source/iot_agent/source/main.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../Eaton_Red_Toolbox_Logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">IoT Agent
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('df/d0a/main_8cpp.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../dc/d18/iot__agent_8hpp_source.html">iot_agent.hpp</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../d2/d86/iot__agent__core_8hpp_source.html">iot_agent_core.hpp</a>&quot;</code><br/>
<code>#include &quot;px/util/util.hpp&quot;</code><br/>
<code>#include &quot;px/util/lib_log.hpp&quot;</code><br/>
<code>#include &quot;px/type/string.hpp&quot;</code><br/>
<code>#include &quot;px/cds/client.hpp&quot;</code><br/>
<code>#include &quot;px/cds/ping_watchdog.hpp&quot;</code><br/>
<code>#include &quot;<a class="el" href="../../db/d95/options_8hpp_source.html">options.hpp</a>&quot;</code><br/>
<code>#include &lt;boost/thread/tss.hpp&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/dce/main_8cpp__incl.png" border="0" usemap="#_2src_2product-ref1_2px-toolkit_2etn__source_2iot__agent_2source_2main_8cpp" alt=""/></div>
<map name="_2src_2product-ref1_2px-toolkit_2etn__source_2iot__agent_2source_2main_8cpp" id="_2src_2product-ref1_2px-toolkit_2etn__source_2iot__agent_2source_2main_8cpp">
<area shape="rect" id="node2" href="../../dc/d18/iot__agent_8hpp.html" title="iot_agent.hpp" alt="" coords="1065,259,1175,285"/><area shape="rect" id="node20" href="../../d2/d86/iot__agent__core_8hpp.html" title="iot_agent_core.hpp" alt="" coords="1047,109,1193,136"/><area shape="rect" id="node29" href="../../db/d95/options_8hpp.html" title="options.hpp" alt="" coords="1571,184,1669,211"/><area shape="rect" id="node9" href="../../d4/d3d/log_8hpp.html" title="log.hpp" alt="" coords="1667,333,1737,360"/></map>
</div>
</div>
<p><a href="../../df/d0a/main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2d987f07078d9f7dec7944ed60a0b358"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#a2d987f07078d9f7dec7944ed60a0b358">MAX_LOG_MSG_LEN</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a2d987f07078d9f7dec7944ed60a0b358"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad638504ee499364fb31342ee5483ab46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#ad638504ee499364fb31342ee5483ab46">sdk_custom_logger</a> (enum IOT_LOG_LEVELS level, const char *funcName, const char *format, va_list vargs)</td></tr>
<tr class="memdesc:ad638504ee499364fb31342ee5483ab46"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IoT Device SDK lets us replace its default logging (which only writes to STDERR or STDOUT) with one of our own, which we will set up like our regular logging, at the _svr_verb_array[SVR_LOG_IOT] level, except that Errors will always be logged.  <a href="#ad638504ee499364fb31342ee5483ab46">More...</a><br/></td></tr>
<tr class="separator:ad638504ee499364fb31342ee5483ab46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af609bfc109371cac8911c2bf1622085c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#af609bfc109371cac8911c2bf1622085c">config_log</a> (std::shared_ptr&lt; <a class="el" href="../../dc/d9e/classCOptions.html">COptions</a> &gt; &amp;options)</td></tr>
<tr class="memdesc:af609bfc109371cac8911c2bf1622085c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the syslog debugging options and levels for this application and the libpx library subsystems.  <a href="#af609bfc109371cac8911c2bf1622085c">More...</a><br/></td></tr>
<tr class="separator:af609bfc109371cac8911c2bf1622085c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/de9/group__iot__startup.html#ga0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:ga0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">The program entry point, <a class="el" href="../../d5/de9/group__iot__startup.html#ga0ddf1224851353fc92bfbff6f499fa97" title="The program entry point, main(). ">main()</a>.  <a href="../../d5/de9/group__iot__startup.html#ga0ddf1224851353fc92bfbff6f499fa97">More...</a><br/></td></tr>
<tr class="separator:ga0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a753be691e23f7e512c65084011edc6e6"><td class="memItemLeft" align="right" valign="top">boost::thread_specific_ptr<br class="typebreak"/>
&lt; toolkit::CSysLog &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#a753be691e23f7e512c65084011edc6e6">_thr_local_syslog</a></td></tr>
<tr class="separator:a753be691e23f7e512c65084011edc6e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad17fd6598e0c094961ed3bc87c44a56"><td class="memItemLeft" align="right" valign="top">std::array&lt; unsigned int, <br class="typebreak"/>
<a class="el" href="../../d6/df9/group__iot__logging.html#gga63c0d5db879d072af3574eee592ce9b6a013a0b3697e858402e96d6c54ce616a1">SVR_LOG_LIST_END</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#aad17fd6598e0c094961ed3bc87c44a56">_svr_verb_array</a></td></tr>
<tr class="memdesc:aad17fd6598e0c094961ed3bc87c44a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">An external map of verbosity levels for the different subsystems defined by svr_log_lvl_t.  <a href="#aad17fd6598e0c094961ed3bc87c44a56">More...</a><br/></td></tr>
<tr class="separator:aad17fd6598e0c094961ed3bc87c44a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67445ab278cc49e898796102b011a76a"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d0a/main_8cpp.html#a67445ab278cc49e898796102b011a76a">main_loop</a></td></tr>
<tr class="separator:a67445ab278cc49e898796102b011a76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a2d987f07078d9f7dec7944ed60a0b358"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_LOG_MSG_LEN&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad638504ee499364fb31342ee5483ab46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sdk_custom_logger </td>
          <td>(</td>
          <td class="paramtype">enum IOT_LOG_LEVELS&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>funcName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>vargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The IoT Device SDK lets us replace its default logging (which only writes to STDERR or STDOUT) with one of our own, which we will set up like our regular logging, at the _svr_verb_array[SVR_LOG_IOT] level, except that Errors will always be logged. </p>
<p>One change from the command-line debug level, which would normally limit the Info and Debug messages: since we enable the SDK logging level based on the command-line _svr_verb_array[SVR_LOG_IOT] level at startup, we would not even normally get Info or Debug messages appearing here if using a default level like 0 or 1. However, if the operator "kicked up" the SDK log leve by sending USR1 signals, these messages would start appearing. Since this is what the operator specifically wants (manual intervention was made, with this intent), we will now accept and log any messages that appear here from the SDK.</p>
<p>To "kick up" the SDK log level, use these commands: pidof iot_agent (to learn the Process ID number) sudo kill -s USR1 1465 (or whatever the PID is), or sudo kill -s USR1 <code>pidof iot_agent</code> Note that this will roll over to None if you send a USR1 signal when the SDK's log level is already at Debug (check the logged output to see what any new level is at).</p>
<p>This function conforms to the SDK's typedef for CustomLoggerCallback</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">level</td><td>SDK Log message level (Error, Info, or Debug) </td></tr>
    <tr><td class="paramname">funcName</td><td>Name of function originating log message. </td></tr>
    <tr><td class="paramname">format</td><td>Log message string. </td></tr>
    <tr><td class="paramname">vargs</td><td>Variable list of arguments for format string. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/d0a/main_8cpp_source.html#l00055">55</a> of file <a class="el" href="../../df/d0a/main_8cpp_source.html">main.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d0a/main_8cpp_ad638504ee499364fb31342ee5483ab46_icgraph.png" border="0" usemap="#df/d0a/main_8cpp_ad638504ee499364fb31342ee5483ab46_icgraph" alt=""/></div>
<map name="df/d0a/main_8cpp_ad638504ee499364fb31342ee5483ab46_icgraph" id="df/d0a/main_8cpp_ad638504ee499364fb31342ee5483ab46_icgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#af609bfc109371cac8911c2bf1622085c" title="Configure the syslog debugging options and levels for this application and the libpx library subsyste..." alt="" coords="203,5,291,32"/><area shape="rect" id="node3" href="../../d5/de9/group__iot__startup.html#ga0ddf1224851353fc92bfbff6f499fa97" title="The program entry point, main(). " alt="" coords="339,5,394,32"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af609bfc109371cac8911c2bf1622085c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void config_log </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../dc/d9e/classCOptions.html">COptions</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure the syslog debugging options and levels for this application and the libpx library subsystems. </p>
<p>Normally outputs to the system's syslog, unless the -Ns option is requested. (Except for DEBUG builds, when this syslogging option is turned off.) If not daemonized, will also output to stderr (for development debugging).</p>
<p>The global syslog members may be set or changed: _svr_verb_array[], _libpx_verb_array[], _thr_local_syslog (aka SYSLOG_PTR)</p>
<p>The IoT Device SDK now also supports configuration of its logging, so set that up here as well. Enable the SDK Debug level:</p>
<ul>
<li>Always at least Error level</li>
<li>To Info level if SVR_LOG_IOT &gt; 1</li>
<li>To Debug level if SVR_LOG_IOT &gt; 5</li>
<li>Note that the USR1 signal can be used to increase the SDK log level</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">options</td><td>The parsed options, from which this function gets the requested default and subsystem verbosities. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../df/d0a/main_8cpp_source.html#l00124">124</a> of file <a class="el" href="../../df/d0a/main_8cpp_source.html">main.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_cgraph.png" border="0" usemap="#df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_cgraph" alt=""/></div>
<map name="df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_cgraph" id="df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_cgraph">
<area shape="rect" id="node2" href="../../df/d0a/main_8cpp.html#ad638504ee499364fb31342ee5483ab46" title="The IoT Device SDK lets us replace its default logging (which only writes to STDERR or STDOUT) with o..." alt="" coords="142,5,290,32"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_icgraph.png" border="0" usemap="#df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_icgraph" alt=""/></div>
<map name="df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_icgraph" id="df/d0a/main_8cpp_af609bfc109371cac8911c2bf1622085c_icgraph">
<area shape="rect" id="node2" href="../../d5/de9/group__iot__startup.html#ga0ddf1224851353fc92bfbff6f499fa97" title="The program entry point, main(). " alt="" coords="142,5,197,32"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a753be691e23f7e512c65084011edc6e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::thread_specific_ptr&lt;toolkit::CSysLog&gt; _thr_local_syslog</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d0a/main_8cpp_source.html#l00015">15</a> of file <a class="el" href="../../df/d0a/main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aad17fd6598e0c094961ed3bc87c44a56"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt;unsigned int, <a class="el" href="../../d6/df9/group__iot__logging.html#gga63c0d5db879d072af3574eee592ce9b6a013a0b3697e858402e96d6c54ce616a1">SVR_LOG_LIST_END</a>&gt; _svr_verb_array</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An external map of verbosity levels for the different subsystems defined by svr_log_lvl_t. </p>

<p>Definition at line <a class="el" href="../../df/d0a/main_8cpp_source.html#l00018">18</a> of file <a class="el" href="../../df/d0a/main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a67445ab278cc49e898796102b011a76a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../db/d77/classCIotAgentCore.html">CIotAgentCore</a>&gt; main_loop</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../df/d0a/main_8cpp_source.html#l00021">21</a> of file <a class="el" href="../../df/d0a/main_8cpp_source.html">main.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../df/d0a/main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:26:03 for IoT Agent by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
