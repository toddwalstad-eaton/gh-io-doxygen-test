<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>email: Email client overview</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">email
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d0/d06/md__src_product-ref1_px-toolkit_etn_source_email_README.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Email client overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is a simple email client that uses the <a href="http://brianstafford.info/libesmtp/" title="3rd party link">libesmtp library</a> and runs as an init.d process and waits for outgoing email requests. It can be configured by an OOB to send emails in response to alarms and also to send emails periodically optionally with log attachments. Emails can also be sent immediately via the command line, e.g. to send debug information to tech support. Secure SMTP (TLS) is supported.</p>
<h1>How to enable email in your product</h1>
<p>It is on by default in the toolkit, but in your project root <code>config</code> file you can add the following entries </p>
<pre class="fragment"># Enable the SMTP client
CONFIG_EATON_EMAIL?=y
</pre><h1>OOB's used by the email client</h1>
<h2>EmailServerSettings OOB</h2>
<p><a href="https://bitbucket-prod.tcc.etn.com/projects/LNXTK/repos/px-toolkit/browse/etn_source/libpx/tk_proto/hg/EmailServerSettings.proto" title="BitBucket">Defined here</a>. It's used to connect to the SMTP. Example:</p>
<p>cdscmd -go EmailServerSettings -pp ```json { "toolkitStruct": { "emailserver_settings": { "server_address":"mail.etn.com", "server_port":25, "user":"E0012345", "password":"pwd", "from_address":"jax-bbb@eaton.com", "require_tls":true }, "description":"Email Server configuration", "label":"Email server config" } } ```</p>
<h2>EmailRecipientSettings OOB</h2>
<p><a href="https://bitbucket-prod.tcc.etn.com/projects/LNXTK/repos/px-toolkit/browse/etn_source/libpx/tk_proto/hg/EmailRecipientSettings.proto" title="BitBucket">Defined here</a>. It's used to configure when to send emails. Example:</p>
<p>cdscmd -go EmailRecipientSettings -pp ```json { "toolkitStruct": { "emailrecipient_settings": { "recipients": [ { "address":"jackcurtin@eaton.com", "format":"HTML", "attach_alarm_log":true, "attach_trend_log":true, "attach_data_log":false, "periodic_types":"ALL", "periodic_days":1, "periodic_hour":0, "periodic_minute":0, "on_new":"ALL", "on_clear":"ALL", "on_acknowledge":"ALL", "on_note":"NONE", "on_all_devices":false, "on_selected_locations": [ { "location_type":"DEVICE" , "id":16, "on_all_channels":false, "channel_ids": [ 21 ] } ], "on_collective_notification":false, "attach_user_log":true, "attach_device_log":true, "attach_config_log":true, "attach_session_log":true, "attach_command_log":true, "attach_update_log":true } ] }, "description":"Email Recipient configuration", "label":"Email recipient config" } } ```</p>
<h1>Static configuration file email.config</h1>
<p><a href="https://bitbucket-prod.tcc.etn.com/projects/LNXTK/repos/px-toolkit/browse/etn_source/email/rootfs/etc/email.config" title="BitBucket">Default here</a></p>
<h1>Command line options</h1>
<p>email -hv ``` Usage: email [-D &lt;verbosity&gt;] [-Dm &lt;verbosity&gt;] [-Ds &lt;subsystem&gt; &lt;verbosity&gt;] [-Ns] -c &lt;absolute file="" path&gt;=""&gt; [-d] [-g &lt;user&gt;] [-h] [-hv] [-ma &lt;file&gt;] [-mb &lt;string&gt;] [-mf &lt;string&gt;] [-ms &lt;string&gt;] [-mt &lt;string&gt;] [-n &lt;prio&gt;] [-pm &lt;policy&gt; &lt;prio&gt;] [-rt] [-ts] [-u &lt;user&gt;] [-v] [-w &lt;seconds&gt;]</p>
<p>-D : &ndash;debug : Set the overall server debugging verbosity level </p>
<pre class="fragment">      This option sets the debugging verbosity level of the entire server;
      it may be overridden by one of the thread-specific debugging options.
      Verbosity levels vary from 0, at which point only the most critical
      messages are displayed, to &gt;=5, beyond which every function call
      prints its entry &amp; exit point.  Output is directed to stderr as well
      as to the Linux system log daemon.

      (default: 1)
</pre><p>-Dm : &ndash;main-debug : Set the debugging verbosity level for the main thread </p>
<pre class="fragment">           This option sets the debugging verbosity level for the main
           thread.  This thread handles the back-end dispatch and
           fulfillment of requests, independently from the original source
           (serial, network, etc.)

           (no default)
</pre><p>-Ds : &ndash;system-debug : Set the debugging verbosity level for an individual subsystem </p>
<pre class="fragment">             This option overrides the debugging verbosity level for a
             particular server subsystem.  Available subsystems: 'default',
             'libpx', 'tcp_io', 'protocol', 'smtp_protocol', 'cds_io',
             'email'
</pre><p>-Ns : &ndash;no-syslogd : Don't direct log messages to syslogd </p>
<pre class="fragment">           By default the server prints each log mess to stderr and passes
           a second copy to syslog(3).  This is ideal when running as a
           daemon, since important output can be read later from the
           syslog.  When debugging, though, it can slow down the server
           considerably, and flood the syslog with messages.  If you are
           running the server in the foreground for the purpose of
           debugging, using this flag will suppress syslogd output and
           improve performance at high verbosity levels.

           (default: false)
</pre><p>-c : &ndash;config : &lt;absolute file="" path&gt;=""&gt; Provides the name of the configuration file </p>
<pre class="fragment">       This option defines the configuration settings the Email Server will
       use for processing.

       (no default)
</pre><p>-d : &ndash;nofork : Prevent the server from daemonizing </p>
<pre class="fragment">       The server normally daemonizes, i.e. it double-forks and runs as a
       background process, closing default file descriptors (stdin, stdout,
       stderr) and leaving the control of the owning TTY.  When debugging a
       problem this may not be desired, so this option allows you to
       disable daemonization.

       (default: false)
</pre><p>-g : &ndash;gid : Run as the given group (name or GID) </p>
<pre class="fragment">    This option causes the server to use getuid(2) to execute as the
    specified group rather than as whoever started the process.  The
    purpose of this option is to allow read access to the user password
    file. Typically root priveleges are required to do this.  The given
    group can be a string name or a GID value.

    (no default)
</pre><p>-h : &ndash;help : Print usage information to stderr and exit </p>
<pre class="fragment">     This prints general usage information, including a program synopsis
     and general description for each option.
</pre><p>-hv : &ndash;usage : Print detailed/verbose usage information to stderr and exit </p>
<pre class="fragment">      This prints usage information similar to that shown for "--help";
      however, extra details are shown for this flag, including a more
      in-depth discussion of each option and displaying default values.
</pre><p>-ma : &ndash;mail-att : Send test Email (mail attachment) </p>
<pre class="fragment">         This option specifies the mail attachment of a test email. Using
         this option causes the email server to send one test Email and
         exit.

         (no default)
</pre><p>-mb : &ndash;mail-body : Send test Email (mail body) </p>
<pre class="fragment">          This option specifies the mail body of a test email. Using this
          option causes the email server to send one test Email and exit.

          (no default)
</pre><p>-mf : &ndash;mail-from : Send test Email (mail from) </p>
<pre class="fragment">          This option specifies the mail sender of a test email. Using this
          option causes the email server to send one test Email and exit.

          (no default)
</pre><p>-ms : &ndash;mail-subj : Send test Email (mail subject) </p>
<pre class="fragment">          This option specifies the mail subject of a test email. Using
          this option causes the email server to send one test Email and
          exit.

          (no default)
</pre><p>-mt : &ndash;mail-to : Send test Email (mail to) </p>
<pre class="fragment">        This option specifies the mail recipient of a test email. Using
        this option causes the email server to send one test Email and exit.

        (no default)
</pre><p>-n : &ndash;priority : Set the (non-real-time) priority/nice level for the server </p>
<pre class="fragment">         The priority field for normal scheduling is a number between -20
         and 19, with -20 being the "best" number.  This option utilizes
         setpriority(2) to set the process-wide priority under "normal"
         scheduling policy.  It is overridden by any per-thread real-time
         scheduling settings for the thread(s) for which they are specified.

         (no default)
</pre><p>-pm : &ndash;main-prio : Set the real-time priority for the main thread </p>
<pre class="fragment">          The policy used for per-thread, real-time scheduling can be one
          of: 'normal', 'batch', 'fifo', or 'rr'.  See
          sched_setscheduler(2) for a detailed description of these
          policies, and their allowed priority ranges.  An error will be
          produced if the priority is outside of the range allowed for the
          given policy.  This option sets the priority of the main thread,
          i.e. the parts that actually communicate with the rest of the
          Toolkit and fetch real data.
</pre><p>-rt : &ndash;require-tls : Require Start TLS </p>
<pre class="fragment">            This option requires a STARTTLS session with the SMTP server.

            (default: false)
</pre><p>-ts : &ndash;test-server : Test connection to the SMTP server </p>
<pre class="fragment">            This option tests the connection to the SMTP server and exits.

            (default: false)
</pre><p>-u : &ndash;uid : Run as the given user (name or UID) </p>
<pre class="fragment">    This option causes the server to use setuid(2) to execute as the
    specified user rather than as whoever started the process.  Typically
    root priveleges are required to do this.  The given user can be a
    string name or a UID value.

    (no default)
</pre><p>-v : &ndash;version : Print version information to stderr and exit </p>
<pre class="fragment">        This option prints usage information, including the Toolkit
        version, build date, and revision number.  However, be aware that
        version information is only updated when this particular file is
        changed, so this information is not necessarily up to date - if in
        doubt, you should compare against a known firmware version.
</pre><p>-w : &ndash;watchdog-timeout : Set the CDS watchdog timeout</p>
<p>This option sets the timeout value for the CDS watchdog. The server will register with the CDS watchdog subsystem at this interval, and ping it more often than is needed to prevent tripping the watchdog. Set to 0 to disable.</p>
<p>(default: 60) ``` </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri May 7 2021 20:25:43 for email by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
