<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libpx: px::db::CKeyValueStore Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libpx
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d6e/classpx_1_1db_1_1CKeyValueStore.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d3/d31/classpx_1_1db_1_1CKeyValueStore-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">px::db::CKeyValueStore Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Read-write Key/Value Store.  
 <a href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for px::db::CKeyValueStore:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d96/classpx_1_1db_1_1CKeyValueStore__coll__graph.png" border="0" usemap="#px_1_1db_1_1CKeyValueStore_coll__map" alt="Collaboration graph"/></div>
<map name="px_1_1db_1_1CKeyValueStore_coll__map" id="px_1_1db_1_1CKeyValueStore_coll__map">
<area shape="rect" id="node4" title="STL class. " alt="" coords="195,5,352,83"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3531d5e8d7ede1f9a2e18ee3e057a108"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a3531d5e8d7ede1f9a2e18ee3e057a108">CKeyValueStore</a> (const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;name, bool create=false, bool compress=true)</td></tr>
<tr class="memdesc:a3531d5e8d7ede1f9a2e18ee3e057a108"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a3531d5e8d7ede1f9a2e18ee3e057a108">More...</a><br/></td></tr>
<tr class="separator:a3531d5e8d7ede1f9a2e18ee3e057a108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9ef82f851bee7ab9ae3bdb305494a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a3a9ef82f851bee7ab9ae3bdb305494a5">~CKeyValueStore</a> ()</td></tr>
<tr class="memdesc:a3a9ef82f851bee7ab9ae3bdb305494a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#a3a9ef82f851bee7ab9ae3bdb305494a5">More...</a><br/></td></tr>
<tr class="separator:a3a9ef82f851bee7ab9ae3bdb305494a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a925ab8f28998f4779270d15caa9a0b9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> <a class="el" href="../../d9/ddb/classpx_1_1db_1_1CIterator.html">CIterator</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a925ab8f28998f4779270d15caa9a0b9a">iterator</a> (bool cache=true) const </td></tr>
<tr class="memdesc:a925ab8f28998f4779270d15caa9a0b9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an iterator into the database.  <a href="#a925ab8f28998f4779270d15caa9a0b9a">More...</a><br/></td></tr>
<tr class="separator:a925ab8f28998f4779270d15caa9a0b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c32e184d847c23204af9388122e1218"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a5c32e184d847c23204af9388122e1218">write</a> (<a class="el" href="../../dc/d98/classpx_1_1db_1_1CBatch.html">CBatch</a> &amp;batch, bool sync=true)</td></tr>
<tr class="memdesc:a5c32e184d847c23204af9388122e1218"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a batch of updates to the database.  <a href="#a5c32e184d847c23204af9388122e1218">More...</a><br/></td></tr>
<tr class="separator:a5c32e184d847c23204af9388122e1218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30cb033828052a47f7133ad0d57678da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a30cb033828052a47f7133ad0d57678da">make_table</a> (const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;name, bool compress=true) const </td></tr>
<tr class="memdesc:a30cb033828052a47f7133ad0d57678da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a single SSTable from this database.  <a href="#a30cb033828052a47f7133ad0d57678da">More...</a><br/></td></tr>
<tr class="separator:a30cb033828052a47f7133ad0d57678da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc3edf507cabe46b2f300dd16fbab8c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#acdc3edf507cabe46b2f300dd16fbab8c">compact</a> (const <a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a> &amp;begin_key=<a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a>(), const <a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a> &amp;end_key=<a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a>())</td></tr>
<tr class="memdesc:acdc3edf507cabe46b2f300dd16fbab8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compact the database from begin_key to end_key.  <a href="#acdc3edf507cabe46b2f300dd16fbab8c">More...</a><br/></td></tr>
<tr class="separator:acdc3edf507cabe46b2f300dd16fbab8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aaaf76baa5ad08adfa41dfadbd9ab8daa"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#aaaf76baa5ad08adfa41dfadbd9ab8daa">repair</a> (const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;name)</td></tr>
<tr class="memdesc:aaaf76baa5ad08adfa41dfadbd9ab8daa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to repair a corrupted database file, given the path name.  <a href="#aaaf76baa5ad08adfa41dfadbd9ab8daa">More...</a><br/></td></tr>
<tr class="separator:aaaf76baa5ad08adfa41dfadbd9ab8daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a7e6579744375c00150b2bd38b6b18461"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a7e6579744375c00150b2bd38b6b18461">renew_owner</a> ()</td></tr>
<tr class="memdesc:a7e6579744375c00150b2bd38b6b18461"><td class="mdescLeft">&#160;</td><td class="mdescRight">Useful for testing &ndash; acquire a new iterator owner (thus invalidating all outstanding iterators) without actually closing the database.  <a href="#a7e6579744375c00150b2bd38b6b18461">More...</a><br/></td></tr>
<tr class="separator:a7e6579744375c00150b2bd38b6b18461"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4585525a75da073383aba45d59cbef6c"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; leveldb::DB &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#a4585525a75da073383aba45d59cbef6c">_db</a></td></tr>
<tr class="memdesc:a4585525a75da073383aba45d59cbef6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to the LevelDB database.  <a href="#a4585525a75da073383aba45d59cbef6c">More...</a><br/></td></tr>
<tr class="separator:a4585525a75da073383aba45d59cbef6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5256ee49e1e049a1dde09ff844b47f9"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../de/d3c/classpx_1_1db_1_1CIteratorOwner.html">CIteratorOwner</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#ae5256ee49e1e049a1dde09ff844b47f9">_iter_owner</a></td></tr>
<tr class="memdesc:ae5256ee49e1e049a1dde09ff844b47f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy "owner" for iterators on this table, to enforce their validity.  <a href="#ae5256ee49e1e049a1dde09ff844b47f9">More...</a><br/></td></tr>
<tr class="separator:ae5256ee49e1e049a1dde09ff844b47f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeac1f7e994a2d43186fec55ca3c48de"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="../../da/d4d/classpx_1_1db_1_1CLevelDBLogger.html">CLevelDBLogger</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html#afeac1f7e994a2d43186fec55ca3c48de">_logger</a></td></tr>
<tr class="memdesc:afeac1f7e994a2d43186fec55ca3c48de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log-control object.  <a href="#afeac1f7e994a2d43186fec55ca3c48de">More...</a><br/></td></tr>
<tr class="separator:afeac1f7e994a2d43186fec55ca3c48de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Read-write Key/Value Store. </p>
<p>This class abstracts away the implementation of a key/value database. Keys are treated as opaque binary blobs, which are sorted lexicographically in the underlying storage, and accessed in an ordered manner.</p>
<p>That means that the "schema" of the database is defined solely by the details of which pieces of information (in what order) go into the binary key. This class doesn't concern itself with the schema, since it treats the key opaquely. Higher-level logic built on top of this class is therefore responsible for correctly interpreting keys according to a meaningful ordering. </p>

<p>Definition at line <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00036">36</a> of file <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3531d5e8d7ede1f9a2e18ee3e057a108"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">px::db::CKeyValueStore::CKeyValueStore </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>create</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Opens the named file as a LevelDB database</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the file to open. Must not be empty.</td></tr>
    <tr><td class="paramname">create</td><td>Should we create the DB if it doesn't exist?</td></tr>
    <tr><td class="paramname">compress</td><td>Should we compress entries that are written to the database?</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d1/d2c/structpx_1_1generic__err.html" title="Exception class used to indicate a generic error. ">generic_err</a></td><td>Thrown if the file can not be opened </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00021">21</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>References <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00156">_db</a>, <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00161">_iter_owner</a>, <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00166">_logger</a>, <a class="el" href="../../d3/d59/iterator__owner_8hpp_source.html#l00029">px::db::CIteratorOwner::create()</a>, and <a class="el" href="../../df/d8a/namespacepx_1_1sub.html#a50eee3d6fefc0fe134ed0e5afe356483">px::sub::create()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d6e/classpx_1_1db_1_1CKeyValueStore_a3531d5e8d7ede1f9a2e18ee3e057a108_cgraph.png" border="0" usemap="#db/d6e/classpx_1_1db_1_1CKeyValueStore_a3531d5e8d7ede1f9a2e18ee3e057a108_cgraph" alt=""/></div>
<map name="db/d6e/classpx_1_1db_1_1CKeyValueStore_a3531d5e8d7ede1f9a2e18ee3e057a108_cgraph" id="db/d6e/classpx_1_1db_1_1CKeyValueStore_a3531d5e8d7ede1f9a2e18ee3e057a108_cgraph">
<area shape="rect" id="node2" href="../../de/d3c/classpx_1_1db_1_1CIteratorOwner.html#afcae970c3d683138e91322475cc21c3d" title="Factory function to create a new iterator owner object. " alt="" coords="227,5,397,46"/><area shape="rect" id="node3" href="../../df/d8a/namespacepx_1_1sub.html#a50eee3d6fefc0fe134ed0e5afe356483" title="Global declaration of create function It returns the validation object based on the object name (oob/..." alt="" coords="253,71,371,97"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3a9ef82f851bee7ab9ae3bdb305494a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">px::db::CKeyValueStore::~CKeyValueStore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00071">71</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a925ab8f28998f4779270d15caa9a0b9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/ddb/classpx_1_1db_1_1CIterator.html">px::db::CIterator</a> px::db::CKeyValueStore::iterator </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cache</em> = <code>true</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an iterator into the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>If true, data read by this iterator is cached by LevelDB to help speed up future reads</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An iterator into the database, which is not initially pointing to any valid entry </dd></dl>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00083">83</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02450">px::db::allocate_ids()</a>, <a class="el" href="../../d2/d2f/perf____adapter_8cpp_source.html#l00045">BOOST_AUTO_TEST_CASE()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02276">px::db::CheckIDDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01992">px::db::CleanupAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01739">px::db::DeleteAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01822">px::db::DeleteClosedAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05974">px::db::DeleteTrends()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06056">px::db::DeleteTrendsInternal()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05880">px::db::DoesKeyExist()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05377">px::db::ExportTrendBucket()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l03191">px::db::ExportTrendStage()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00593">px::db::FetchChannels()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00488">px::db::FetchDevices()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00359">px::db::FetchOOB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00383">px::db::FetchOOBKeys()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00407">px::db::FetchOOBs()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00132">px::db::GetSchemaVersion()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06573">px::db::IsTrendStageDbTombstoned()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06240">px::db::LevelupBucketTrends()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06167">px::db::LevelupBucketTrendsForChannel()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01652">px::db::LoadActiveAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00731">px::db::MigrateAlarmDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00228">px::db::MigrateChannelDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00175">px::db::MigrateDeviceDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05655">px::db::MoveTrendsFromStageToBucket()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00840">px::db::query_alarm_index_db()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01021">px::db::QueryAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01450">px::db::QueryAlarmsLatestUpdate()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02807">px::db::QueryTrendStage()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02522">px::db::reserve_ids()</a>, and <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06586">px::db::SetTrendStageDbTombstoned()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c32e184d847c23204af9388122e1218"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void px::db::CKeyValueStore::write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d98/classpx_1_1db_1_1CBatch.html">CBatch</a> &amp;&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sync</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a batch of updates to the database. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch</td><td>The sequence of updates to be written</td></tr>
    <tr><td class="paramname">sync</td><td>If true, the database is synchronously flushed to disk</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d1/d2c/structpx_1_1generic__err.html" title="Exception class used to indicate a generic error. ">generic_err</a></td><td>Thrown if an error is encountered while writing this batch of updates </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00097">97</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>References <a class="el" href="../../d1/d41/batch_8hpp_source.html#l00098">px::db::CBatch::_batch</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02450">px::db::allocate_ids()</a>, <a class="el" href="../../d2/d2f/perf____adapter_8cpp_source.html#l00045">BOOST_AUTO_TEST_CASE()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02276">px::db::CheckIDDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01992">px::db::CleanupAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01739">px::db::DeleteAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01822">px::db::DeleteClosedAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05974">px::db::DeleteTrends()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06056">px::db::DeleteTrendsInternal()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06167">px::db::LevelupBucketTrendsForChannel()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06311">px::db::LevelupBucketTrendsRow()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00731">px::db::MigrateAlarmDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00228">px::db::MigrateChannelDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00175">px::db::MigrateDeviceDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05655">px::db::MoveTrendsFromStageToBucket()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01718">px::db::NoteAlarmsToDelete()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l02522">px::db::reserve_ids()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00885">px::db::SaveAlarmUpdates()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00114">px::db::SetSchemaVersion()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06586">px::db::SetTrendStageDbTombstoned()</a>, and <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l04086">px::db::StoreTrendBucketsToDb()</a>.</p>

</div>
</div>
<a class="anchor" id="a30cb033828052a47f7133ad0d57678da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void px::db::CKeyValueStore::make_table </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a single SSTable from this database. </p>
<p>This call provides a convenient way to create a sorted string table: you can use the key/value store interface to add as many items as you want, in no particular order, then invoke this call to iterate over the (now ordered) contents of the database, and use them to create a single sorted string table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The filename to which the table will be written. Must not be empty.</td></tr>
    <tr><td class="paramname">compress</td><td>Should we compress entries that are written to the sstable?</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="../../d1/d2c/structpx_1_1generic__err.html" title="Exception class used to indicate a generic error. ">generic_err</a></td><td>Thrown if an error is encountered while creating the table </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00123">123</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>References <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00024">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="acdc3edf507cabe46b2f300dd16fbab8c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void px::db::CKeyValueStore::compact </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a> &amp;&#160;</td>
          <td class="paramname"><em>begin_key</em> = <code><a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a> &amp;&#160;</td>
          <td class="paramname"><em>end_key</em> = <code><a class="el" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html">CBlobHolder</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compact the database from begin_key to end_key. </p>
<p>If either is omitted, go to the beginning and/or end of the database. Will increase space usage if ran while an iterator is being held to the same DB. </p>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00181">181</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>References <a class="el" href="../../d0/da4/blob__holder_8hpp_source.html#l00091">px::db::CBlobHolder::get()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00020">likely</a>, and <a class="el" href="../../d0/da4/blob__holder_8hpp_source.html#l00167">px::db::CBlobHolder::size()</a>.</p>

<p>Referenced by <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01992">px::db::CleanupAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05960">px::db::compact_trend_bucket_channel_range()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01739">px::db::DeleteAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l01822">px::db::DeleteClosedAlarms()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l06056">px::db::DeleteTrendsInternal()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00731">px::db::MigrateAlarmDB()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00228">px::db::MigrateChannelDB()</a>, and <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l00175">px::db::MigrateDeviceDB()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d6e/classpx_1_1db_1_1CKeyValueStore_acdc3edf507cabe46b2f300dd16fbab8c_cgraph.png" border="0" usemap="#db/d6e/classpx_1_1db_1_1CKeyValueStore_acdc3edf507cabe46b2f300dd16fbab8c_cgraph" alt=""/></div>
<map name="db/d6e/classpx_1_1db_1_1CKeyValueStore_acdc3edf507cabe46b2f300dd16fbab8c_cgraph" id="db/d6e/classpx_1_1db_1_1CKeyValueStore_acdc3edf507cabe46b2f300dd16fbab8c_cgraph">
<area shape="rect" id="node2" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html#a317052482c1e83504ebabba6e03f86c2" title="Get a LevelDB slice referring to this blob. " alt="" coords="227,5,407,32"/><area shape="rect" id="node3" href="../../d3/dc9/classpx_1_1db_1_1CBlobHolder.html#ae23f62eb28dc9d343999870666145e9f" title="Get the current size of the blob. " alt="" coords="242,57,393,98"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaaf76baa5ad08adfa41dfadbd9ab8daa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void px::db::CKeyValueStore::repair </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/namespacepx.html#a7acb13796ae56fe8e773fe781eedd790">px::string</a> &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to repair a corrupted database file, given the path name. </p>
<p>Name must not be empty. </p>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00212">212</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7e6579744375c00150b2bd38b6b18461"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void px::db::CKeyValueStore::renew_owner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Useful for testing &ndash; acquire a new iterator owner (thus invalidating all outstanding iterators) without actually closing the database. </p>

<p>Definition at line <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00207">207</a> of file <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a>.</p>

<p>References <a class="el" href="../../d3/d59/iterator__owner_8hpp_source.html#l00029">px::db::CIteratorOwner::create()</a>.</p>

<p>Referenced by <a class="el" href="../../d8/d89/test__helper_8hpp_source.html#l00028">px::db::CTestHelper::renew_iterator_owner()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d6e/classpx_1_1db_1_1CKeyValueStore_a7e6579744375c00150b2bd38b6b18461_cgraph.png" border="0" usemap="#db/d6e/classpx_1_1db_1_1CKeyValueStore_a7e6579744375c00150b2bd38b6b18461_cgraph" alt=""/></div>
<map name="db/d6e/classpx_1_1db_1_1CKeyValueStore_a7e6579744375c00150b2bd38b6b18461_cgraph" id="db/d6e/classpx_1_1db_1_1CKeyValueStore_a7e6579744375c00150b2bd38b6b18461_cgraph">
<area shape="rect" id="node2" href="../../de/d3c/classpx_1_1db_1_1CIteratorOwner.html#afcae970c3d683138e91322475cc21c3d" title="Factory function to create a new iterator owner object. " alt="" coords="227,5,397,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a4585525a75da073383aba45d59cbef6c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;leveldb::DB&gt; px::db::CKeyValueStore::_db</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle to the LevelDB database. </p>

<p>Definition at line <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00156">156</a> of file <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00021">CKeyValueStore()</a>.</p>

</div>
</div>
<a class="anchor" id="ae5256ee49e1e049a1dde09ff844b47f9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../de/d3c/classpx_1_1db_1_1CIteratorOwner.html">CIteratorOwner</a>&gt; px::db::CKeyValueStore::_iter_owner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dummy "owner" for iterators on this table, to enforce their validity. </p>

<p>Definition at line <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00161">161</a> of file <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00021">CKeyValueStore()</a>.</p>

</div>
</div>
<a class="anchor" id="afeac1f7e994a2d43186fec55ca3c48de"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="../../da/d4d/classpx_1_1db_1_1CLevelDBLogger.html">CLevelDBLogger</a>&gt; px::db::CKeyValueStore::_logger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Log-control object. </p>

<p>Definition at line <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html#l00166">166</a> of file <a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a>.</p>

<p>Referenced by <a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html#l00021">CKeyValueStore()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d6/d4c/key__value__store_8hpp_source.html">key_value_store.hpp</a></li>
<li><a class="el" href="../../dd/d9b/key__value__store_8cpp_source.html">key_value_store.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/dcb/namespacepx.html">px</a></li><li class="navelem"><a class="el" href="../../dd/d42/namespacepx_1_1db.html">db</a></li><li class="navelem"><a class="el" href="../../db/d6e/classpx_1_1db_1_1CKeyValueStore.html">CKeyValueStore</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:24:24 for libpx by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
