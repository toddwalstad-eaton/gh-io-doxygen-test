<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libpx: trend_accumulator.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libpx
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/dde/trend__accumulator_8cpp_source.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">trend_accumulator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../db/dde/trend__accumulator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d3a/common_8hpp.html">px/common.hpp</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d1e/exception_8hpp.html">px/exception.hpp</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d05/trend__accumulator_8hpp.html">px/data/trend_accumulator.hpp</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/dca/adapter_8hpp.html">px/db/adapter.hpp</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d3d/log_8hpp.html">log.hpp</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// See .hpp for descriptions</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5fb52844a02c43bc32496693135efd21">   10</a></span>&#160;<a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5fb52844a02c43bc32496693135efd21">px::CTrendAccumulator::CTrendAccumulator</a>()</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        : _previous_acc{ <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>() },</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        _acc{ <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>() }, _channel_datatype( <a class="code" href="../../de/dcb/namespacepx.html#acf6770f6d835c0c868d8be96d1771e3fafedb2d84cafe20862cb4399751a8a7e3">px::datatype::invalid</a> )</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{}</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// See .hpp for descriptions</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a87a6d542367a33931a33431d1b7754dc">   18</a></span>&#160;<a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5fb52844a02c43bc32496693135efd21">px::CTrendAccumulator::CTrendAccumulator</a>( <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html">CTrendAccumulator</a> &amp;&amp;arg )</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        : _previous_acc( std::move( arg._previous_acc ) ),</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        _acc( std::move( arg._acc ) ), _channel_datatype( arg._channel_datatype )</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{}</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940">   28</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940">px::CTrendAccumulator::update</a>( <span class="keyword">const</span> <a class="code" href="../../d9/d7d/classpx_1_1CWallTime.html">px::CWallTime</a> &amp;timestamp,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                                                        <span class="keyword">const</span> <a class="code" href="../../db/dd9/classpx_1_1CValue.html">px::CValue</a> &amp;value, <span class="keyword">const</span> <a class="code" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a> channel_datatype,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                                                        std::shared_ptr&lt;px::CTrendStageUpdate&gt; &amp;trend_stage_update )</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="comment">// normalized to the interval&#39;s ending timestamp.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        uint32_t time {0};      <span class="comment">// in minutes</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordtype">bool</span> on_interval {<span class="keyword">false</span>};</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="comment">// Get the interval end time (in minutes UTC since 1970) given this timestamp</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="../../dd/d42/namespacepx_1_1db.html#a93c327007ff894fa4691acbf52269ede">px::db::get_normalized_interval_timestamp</a>( timestamp, _interval_minutes, time, on_interval );</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">if</span> ( time == 0 )</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                <span class="comment">// ignore invalid timestamp</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        acc_mutex.lock();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">// Save what datatype this channel is</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        _channel_datatype = channel_datatype;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> ( _acc-&gt;time == 0 )</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                <span class="comment">// very first value</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="keywordflow">if</span> ( _previous_acc-&gt;time != 0 )</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="comment">// assert(false); // should never happen</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                        _previous_acc.reset( <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>() );</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                        <a class="code" href="../../d4/d3d/log_8hpp.html#aa8ec782c869726676d2a38e6bdc1d8db">LIBPX_FNOTICE</a>( 1, <span class="stringliteral">&quot;Unexpected: resetting previous accumulator&quot;</span> );</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                _acc-&gt;time = time;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span> ( time == _acc-&gt;time )</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                <span class="comment">// the value fits the current accumulator interval</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                <span class="comment">// LIBPX_FNOTICE( 0, &quot;Adding value %s to current accumulator&quot;, value.as_string().c_str() );</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( time &gt; _acc-&gt;time )</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="comment">// the value is for the next interval</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <span class="comment">// But first check: did we get any updates in that just-ended interval?</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="keywordflow">if</span> ( _acc-&gt;is_empty() )</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                        <span class="comment">// No new values were added in the active (just ended) interval.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                        <span class="comment">// Refresh the timestamp of the previous interval, preserving its data,</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                        <span class="comment">// and provide that data for the return. (This is the new, preferred behavior.)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                        _previous_acc-&gt;time = _acc-&gt;time;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                        trend_stage_update = store_previous_results();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                        <span class="comment">// LIBPX_FNOTICE( 0, &quot;Adding value %s to next accumulator after storing previous (no updates)&quot;, value.as_string().c_str() );</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        <span class="comment">// the current interval is ready to be pushed to the stage.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                        <span class="comment">// then swap the current interval to the previous, and reset the current.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                        store_results( channel_datatype, trend_stage_update );</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                        _acc.swap( _previous_acc );</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                        <span class="comment">// LIBPX_FNOTICE( 0, &quot;Adding value %s to next accumulator and closing previous updates&quot;, value.as_string().c_str() );</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                _acc.reset( <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>( time ) );</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                <span class="comment">// the value is for previous interval, indicating the system clock</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="comment">// is probably adjusted backwards.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="comment">// always drop the current accumulator, because we assume that the time</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="comment">// will advance again to cover the current interval soon.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">if</span> ( time == _previous_acc-&gt;time )</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                        <span class="comment">// we still have the previous interval cached, this is the most likely</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        <span class="comment">// case when the system clock is adjusted for a few seconds</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        <span class="comment">// we can re-use the previous interval  (there will be a little overlap,</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        <span class="comment">// but it is much better than drop the previous interval data)</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                        _acc.swap( _previous_acc );</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <a class="code" href="../../d4/d3d/log_8hpp.html#aa8ec782c869726676d2a38e6bdc1d8db">LIBPX_FNOTICE</a>( 1, <span class="stringliteral">&quot;Unexpected: Adding value %s to next accumulator, storing previous as new&quot;</span>, value.<a class="code" href="../../db/dd9/classpx_1_1CValue.html#a746a26c3a4970db4ea4f27f30c5d4d9a">as_string</a>().c_str() );</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                        <span class="comment">// since we do not have the cached previous interval any more,</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                        <span class="comment">// start from new then.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        _acc.reset( <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>( time ) );</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                        <a class="code" href="../../d4/d3d/log_8hpp.html#aa8ec782c869726676d2a38e6bdc1d8db">LIBPX_FNOTICE</a>( 1, <span class="stringliteral">&quot;Unexpected: Adding value %s to next accumulator, starting from new&quot;</span>, value.<a class="code" href="../../db/dd9/classpx_1_1CValue.html#a746a26c3a4970db4ea4f27f30c5d4d9a">as_string</a>().c_str() );</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="comment">// clear the previous interval</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                _previous_acc.reset( <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>() );</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="comment">// for santorini, we will just support trending for float/double</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// calculate the timeoffset (1/10 seconds) to the normalized time.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        int64_t time_tenthseconds = ( int64_t )timestamp.tv_sec * 10 + ( int64_t )timestamp.tv_nsec / 100000000;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        int64_t time_offset = ( int64_t )time * 600 - time_tenthseconds;<span class="comment">// in 1/10 seconds.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        uint32_t abs_time_ofset = time_offset &gt; 0 ? ( uint32_t )time_offset : ( uint32_t )( -time_offset );</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        _acc-&gt;update( abs_time_ofset, value );</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        acc_mutex.unlock();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;}</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">// See .hpp for descriptions</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eedf872067958962540cfee00ae64cb">  128</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eedf872067958962540cfee00ae64cb">px::CTrendAccumulator::store_results</a>( <span class="keyword">const</span> <a class="code" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a> channel_datatype,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                                                   std::shared_ptr&lt;CTrendStageUpdate&gt; &amp;trend_stage_update )</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        trend_stage_update.reset( <span class="keyword">new</span> <a class="code" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a>() );</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        trend_stage_update-&gt;data_type = channel_datatype;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">if</span> ( _acc )</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                trend_stage_update-&gt;time = _acc-&gt;time;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909">avg</a> = 0.0, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a> = 0.0, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a> = 0.0, last = 0.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                uint32_t min_time_offset = 0, max_time_offset = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                _acc-&gt;get( count, avg, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>, min_time_offset, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>, max_time_offset, last );</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                trend_stage_update-&gt;count = count;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                trend_stage_update-&gt;avg = avg;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                trend_stage_update-&gt;min = <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                trend_stage_update-&gt;min_time_offset = min_time_offset;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                trend_stage_update-&gt;max = <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                trend_stage_update-&gt;max_time_offset = max_time_offset;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                trend_stage_update-&gt;actual = last;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">/* Close the trend interval just ended for this accumulator, if not already closed,</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> * calculate the update for the stage, and swap the active accumulator to the inactive one. */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117">  152</a></span>&#160;std::shared_ptr&lt;px::CTrendStageUpdate&gt; <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117">px::CTrendAccumulator::close_interval</a>( uint32_t ended_interval_mins,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                                                                                                                                          uint32_t next_interval_mins )</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        assert( ended_interval_mins &gt; 0 );</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        assert( next_interval_mins &gt; 0 );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        std::shared_ptr&lt;px::CTrendStageUpdate&gt; trend_stage_update;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        acc_mutex.lock();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d3a/common_8hpp.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>( !_acc || !_previous_acc ) )</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="comment">// Not initialized; do nothing</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ended_interval_mins == _previous_acc-&gt;time )</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="comment">// We have already closed this interval for this channel; do nothing further.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( _acc-&gt;is_empty() )</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="comment">// No new values were added in the active (just ended) interval.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="comment">// Refresh the timestamp of the previous interval, preserving its data,</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="comment">// and provide that data for the return.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                _previous_acc-&gt;time = ended_interval_mins;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                trend_stage_update = store_previous_results();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="comment">// Update the active interval&#39;s timestamp, too</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                _acc-&gt;time = next_interval_mins;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ended_interval_mins == _acc-&gt;time )</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="comment">// The current interval is ready to be pushed to the stage.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="comment">// First swap the current interval to the previous, and reset the current.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                _acc.swap( _previous_acc );</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                _acc.reset( <span class="keyword">new</span> <a class="code" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>( next_interval_mins ) );</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="comment">// Then get the (now previous) data for the return</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                trend_stage_update = store_previous_results();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// else: if we went back in time or anything else is not right, do nothing</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="comment">// Let update() straighten it out with good data.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        acc_mutex.unlock();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">return</span> ( trend_stage_update );</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#ae0a89690aef84c13be41d46c57539f05">  195</a></span>&#160;std::shared_ptr&lt;px::CTrendStageUpdate&gt; <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#ae0a89690aef84c13be41d46c57539f05">px::CTrendAccumulator::store_previous_results</a>()</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        std::shared_ptr&lt;px::CTrendStageUpdate&gt; trend_stage_update;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> ( _previous_acc &amp;&amp; !_previous_acc-&gt;is_empty() )</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                trend_stage_update.reset( <span class="keyword">new</span> <a class="code" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">px::CTrendStageUpdate</a>() );</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                trend_stage_update-&gt;data_type = _channel_datatype;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                trend_stage_update-&gt;time = _previous_acc-&gt;time;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordtype">double</span> <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909">avg</a> = 0.0, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a> = 0.0, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a> = 0.0, last = 0.0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                uint32_t min_time_offset = 0, max_time_offset = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                _previous_acc-&gt;get( count, avg, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>, min_time_offset, <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>, max_time_offset, last );</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                trend_stage_update-&gt;count = count;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                trend_stage_update-&gt;avg = avg;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                trend_stage_update-&gt;min = <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                trend_stage_update-&gt;min_time_offset = min_time_offset;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                trend_stage_update-&gt;max = <a class="code" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                trend_stage_update-&gt;max_time_offset = max_time_offset;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                trend_stage_update-&gt;actual = last;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> ( trend_stage_update );</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">// See .hpp for descriptions</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487">  222</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487">px::CTrendAccumulator::get_results</a>( uint32_t &amp;interval_timestamp,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                                                 <span class="keywordtype">int</span> &amp;acc_count,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                                                                 <span class="keywordtype">double</span> &amp;acc_avg, <span class="keywordtype">double</span> &amp;acc_min, <span class="keywordtype">double</span> &amp;acc_max, <span class="keywordtype">double</span> &amp;acc_actual )</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        acc_count = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        interval_timestamp = 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        acc_avg = acc_min = acc_max = acc_actual = NAN;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> ( _acc )</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                acc_mutex.lock();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                interval_timestamp = _acc-&gt;time;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                uint32_t min_time_offset = 0, max_time_offset = 0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                _acc-&gt;get( acc_count, acc_avg, acc_min, min_time_offset, acc_max, max_time_offset, acc_actual );</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                acc_mutex.unlock();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="ttc" id="adapter_8hpp_html"><div class="ttname"><a href="../../d6/dca/adapter_8hpp.html">adapter.hpp</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_a5fb52844a02c43bc32496693135efd21"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5fb52844a02c43bc32496693135efd21">px::CTrendAccumulator::CTrendAccumulator</a></div><div class="ttdeci">PUBLIC CTrendAccumulator()</div><div class="ttdoc">Default constructor. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00010">trend_accumulator.cpp:10</a></div></div>
<div class="ttc" id="classpx_1_1CValueAccumulator_html"><div class="ttname"><a href="../../de/d1e/classpx_1_1CValueAccumulator.html">px::CValueAccumulator</a></div><div class="ttdoc">Represents a light weight accumulator to calculate min, min_time, max, max_time, avg, and last values for CValue. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/df5/value__accumulator_8hpp_source.html#l00017">value_accumulator.hpp:17</a></div></div>
<div class="ttc" id="common_8hpp_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="../../dd/d3a/common_8hpp.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d3a/common_8hpp_source.html#l00024">common.hpp:24</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_a0a68747b8f4a610bf01ba3f786b01940"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940">px::CTrendAccumulator::update</a></div><div class="ttdeci">PUBLIC void update(const px::CWallTime &amp;timestamp, const px::CValue &amp;value, const px::datatype channel_datatype, std::shared_ptr&lt; CTrendStageUpdate &gt; &amp;trend_stage_update)</div><div class="ttdoc">Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00028">trend_accumulator.cpp:28</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html">px::CTrendAccumulator</a></div><div class="ttdoc">Represents an accumulator of values for one channel&amp;#39;s data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/trend__accumulator_8hpp_source.html#l00023">trend_accumulator.hpp:23</a></div></div>
<div class="ttc" id="namespacepx_html_acf6770f6d835c0c868d8be96d1771e3fafedb2d84cafe20862cb4399751a8a7e3"><div class="ttname"><a href="../../de/dcb/namespacepx.html#acf6770f6d835c0c868d8be96d1771e3fafedb2d84cafe20862cb4399751a8a7e3">px::alarm_trigger_type::invalid</a></div></div>
<div class="ttc" id="common_8hpp_html"><div class="ttname"><a href="../../dd/d3a/common_8hpp.html">common.hpp</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_ae0a89690aef84c13be41d46c57539f05"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#ae0a89690aef84c13be41d46c57539f05">px::CTrendAccumulator::store_previous_results</a></div><div class="ttdeci">std::shared_ptr&lt; CTrendStageUpdate &gt; store_previous_results()</div><div class="ttdoc">Stores the results from the previous accumulator to a structure for the stage. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00195">trend_accumulator.cpp:195</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_a3eb59efcc2c972178ac960f7e1261117"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117">px::CTrendAccumulator::close_interval</a></div><div class="ttdeci">PUBLIC std::shared_ptr&lt; CTrendStageUpdate &gt; close_interval(uint32_t ended_interval_mins, uint32_t next_interval_mins)</div><div class="ttdoc">Close the trend interval just ended for this accumulator, if not already closed, calculate the update...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00152">trend_accumulator.cpp:152</a></div></div>
<div class="ttc" id="classpx_1_1CValue_html"><div class="ttname"><a href="../../db/dd9/classpx_1_1CValue.html">px::CValue</a></div><div class="ttdoc">Variadic value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dca/type_2value_8hpp_source.html#l00034">type/value.hpp:34</a></div></div>
<div class="ttc" id="classpx_1_1CWallTime_html"><div class="ttname"><a href="../../d9/d7d/classpx_1_1CWallTime.html">px::CWallTime</a></div><div class="ttdoc">Wall-clock time. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dda/wall__time_8hpp_source.html#l00026">wall_time.hpp:26</a></div></div>
<div class="ttc" id="trend__accumulator_8hpp_html"><div class="ttname"><a href="../../d4/d05/trend__accumulator_8hpp.html">trend_accumulator.hpp</a></div></div>
<div class="ttc" id="log_8hpp_html_aa8ec782c869726676d2a38e6bdc1d8db"><div class="ttname"><a href="../../d4/d3d/log_8hpp.html#aa8ec782c869726676d2a38e6bdc1d8db">LIBPX_FNOTICE</a></div><div class="ttdeci">#define LIBPX_FNOTICE(__VLVL__,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3d/log_8hpp_source.html#l00190">log.hpp:190</a></div></div>
<div class="ttc" id="classpx_1_1CValue_html_a746a26c3a4970db4ea4f27f30c5d4d9a"><div class="ttname"><a href="../../db/dd9/classpx_1_1CValue.html#a746a26c3a4970db4ea4f27f30c5d4d9a">px::CValue::as_string</a></div><div class="ttdeci">PUBLIC px::string as_string() const </div><div class="ttdoc">Conversion to string type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/value_8cpp_source.html#l00307">value.cpp:307</a></div></div>
<div class="ttc" id="exception_8hpp_html"><div class="ttname"><a href="../../d7/d1e/exception_8hpp.html">exception.hpp</a></div></div>
<div class="ttc" id="namespacepx_html_ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909"><div class="ttname"><a href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909">px::trend_trait::avg</a></div><div class="ttdoc">Average value over the interval. </div></div>
<div class="ttc" id="namespacepx_1_1db_html_a93c327007ff894fa4691acbf52269ede"><div class="ttname"><a href="../../dd/d42/namespacepx_1_1db.html#a93c327007ff894fa4691acbf52269ede">px::db::get_normalized_interval_timestamp</a></div><div class="ttdeci">PUBLIC void get_normalized_interval_timestamp(const px::CWallTime &amp;timestamp, const uint32_t aligned_minutes, uint32_t &amp;interval_timestamp, bool &amp;on_interval)</div><div class="ttdoc">Gets the minutes since epoch, or zero if invalid, optionally aligned to an interval in minutes; and a...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d3d/adapter_8cpp_source.html#l05552">adapter.cpp:5552</a></div></div>
<div class="ttc" id="namespacepx_html_ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114"><div class="ttname"><a href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">px::trend_trait::max</a></div><div class="ttdoc">Maximum value over the interval. </div></div>
<div class="ttc" id="log_8hpp_html"><div class="ttname"><a href="../../d4/d3d/log_8hpp.html">log.hpp</a></div><div class="ttdoc">An internal libpx header that defines the syslogging functions. </div></div>
<div class="ttc" id="namespacepx_html_ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a"><div class="ttname"><a href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">px::trend_trait::min</a></div><div class="ttdoc">Minimum value over the interval. </div></div>
<div class="ttc" id="classpx_1_1CTrendStageUpdate_html"><div class="ttname"><a href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">px::CTrendStageUpdate</a></div><div class="ttdoc">Represents an interval update to be stored in the trend stage. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da1/trend__stage__update_8hpp_source.html#l00015">trend_stage_update.hpp:15</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_a3eedf872067958962540cfee00ae64cb"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eedf872067958962540cfee00ae64cb">px::CTrendAccumulator::store_results</a></div><div class="ttdeci">void store_results(const px::datatype channel_datatype, std::shared_ptr&lt; CTrendStageUpdate &gt; &amp;trend_stage_update)</div><div class="ttdoc">Stores the results from the current (active) accumulator to a structure for the stage. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00128">trend_accumulator.cpp:128</a></div></div>
<div class="ttc" id="namespacepx_html_a8231daeb7713d1005025954bc1066422"><div class="ttname"><a href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a></div><div class="ttdeci">datatype</div><div class="ttdoc">This is the standard list of data types available in the Toolkit and exposed via Mercury. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc1/datatype__enums_8hpp_source.html#l00014">datatype_enums.hpp:14</a></div></div>
<div class="ttc" id="classpx_1_1CTrendAccumulator_html_aa574427d2c34bb7fa8200d47d9846487"><div class="ttname"><a href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487">px::CTrendAccumulator::get_results</a></div><div class="ttdeci">PUBLIC void get_results(uint32_t &amp;interval_timestamp, int &amp;acc_count, double &amp;acc_avg, double &amp;acc_min, double &amp;acc_max, double &amp;acc_actual)</div><div class="ttdoc">Get the results from the present accumulator. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dde/trend__accumulator_8cpp_source.html#l00222">trend_accumulator.cpp:222</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_0e92ad6578cdb0742396e0d69fb8d85e.html">source</a></li><li class="navelem"><a class="el" href="../../dir_b92e2075e61483220b82c86a30ed7c49.html">data</a></li><li class="navelem"><a class="el" href="../../db/dde/trend__accumulator_8cpp.html">trend_accumulator.cpp</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:24:20 for libpx by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
