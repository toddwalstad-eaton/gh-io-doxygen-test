<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libpx: px::CTrendAccumulator Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libpx
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d43/classpx_1_1CTrendAccumulator.html','../../');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../da/daa/classpx_1_1CTrendAccumulator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">px::CTrendAccumulator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Represents an accumulator of values for one channel's data.  
 <a href="../../db/d43/classpx_1_1CTrendAccumulator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for px::CTrendAccumulator:</div>
<div class="dyncontent">
<div class="center"><img src="../../dd/d12/classpx_1_1CTrendAccumulator__coll__graph.png" border="0" usemap="#px_1_1CTrendAccumulator_coll__map" alt="Collaboration graph"/></div>
<map name="px_1_1CTrendAccumulator_coll__map" id="px_1_1CTrendAccumulator_coll__map">
<area shape="rect" id="node4" title="STL class. " alt="" coords="104,5,261,83"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5fb52844a02c43bc32496693135efd21"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5fb52844a02c43bc32496693135efd21">CTrendAccumulator</a> ()</td></tr>
<tr class="memdesc:a5fb52844a02c43bc32496693135efd21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#a5fb52844a02c43bc32496693135efd21">More...</a><br/></td></tr>
<tr class="separator:a5fb52844a02c43bc32496693135efd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87a6d542367a33931a33431d1b7754dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a87a6d542367a33931a33431d1b7754dc">CTrendAccumulator</a> (<a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html">CTrendAccumulator</a> &amp;&amp;arg)</td></tr>
<tr class="memdesc:a87a6d542367a33931a33431d1b7754dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move constructor.  <a href="#a87a6d542367a33931a33431d1b7754dc">More...</a><br/></td></tr>
<tr class="separator:a87a6d542367a33931a33431d1b7754dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1dcaca4a1f51895a4c445c077249725"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#ac1dcaca4a1f51895a4c445c077249725">~CTrendAccumulator</a> ()</td></tr>
<tr class="memdesc:ac1dcaca4a1f51895a4c445c077249725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#ac1dcaca4a1f51895a4c445c077249725">More...</a><br/></td></tr>
<tr class="separator:ac1dcaca4a1f51895a4c445c077249725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a68747b8f4a610bf01ba3f786b01940"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940">update</a> (const <a class="el" href="../../d9/d7d/classpx_1_1CWallTime.html">px::CWallTime</a> &amp;<a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422ad7e6d55ba379a13d08c25d15faf2a23b">timestamp</a>, const <a class="el" href="../../db/dd9/classpx_1_1CValue.html">px::CValue</a> &amp;value, const <a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a> channel_datatype, std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt; &amp;trend_stage_update)</td></tr>
<tr class="memdesc:a0a68747b8f4a610bf01ba3f786b01940"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval.  <a href="#a0a68747b8f4a610bf01ba3f786b01940">More...</a><br/></td></tr>
<tr class="separator:a0a68747b8f4a610bf01ba3f786b01940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb59efcc2c972178ac960f7e1261117"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117">close_interval</a> (uint32_t ended_interval_mins, uint32_t next_interval_mins)</td></tr>
<tr class="memdesc:a3eb59efcc2c972178ac960f7e1261117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close the trend interval just ended for this accumulator, if not already closed, calculate the update for the stage, and swap the active accumulator to the inactive one.  <a href="#a3eb59efcc2c972178ac960f7e1261117">More...</a><br/></td></tr>
<tr class="separator:a3eb59efcc2c972178ac960f7e1261117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa574427d2c34bb7fa8200d47d9846487"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487">get_results</a> (uint32_t &amp;interval_timestamp, int &amp;acc_count, double &amp;acc_avg, double &amp;acc_min, double &amp;acc_max, double &amp;acc_actual)</td></tr>
<tr class="memdesc:aa574427d2c34bb7fa8200d47d9846487"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the results from the present accumulator.  <a href="#aa574427d2c34bb7fa8200d47d9846487">More...</a><br/></td></tr>
<tr class="separator:aa574427d2c34bb7fa8200d47d9846487"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3eedf872067958962540cfee00ae64cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eedf872067958962540cfee00ae64cb">store_results</a> (const <a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a> channel_datatype, std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt; &amp;trend_stage_update)</td></tr>
<tr class="memdesc:a3eedf872067958962540cfee00ae64cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the results from the current (active) accumulator to a structure for the stage.  <a href="#a3eedf872067958962540cfee00ae64cb">More...</a><br/></td></tr>
<tr class="separator:a3eedf872067958962540cfee00ae64cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a89690aef84c13be41d46c57539f05"><td class="memItemLeft" align="right" valign="top">std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#ae0a89690aef84c13be41d46c57539f05">store_previous_results</a> ()</td></tr>
<tr class="memdesc:ae0a89690aef84c13be41d46c57539f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the results from the previous accumulator to a structure for the stage.  <a href="#ae0a89690aef84c13be41d46c57539f05">More...</a><br/></td></tr>
<tr class="separator:ae0a89690aef84c13be41d46c57539f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a9cd845267ef3e1f51f146a170eb465b4"><td class="memItemLeft" align="right" valign="top">const uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a9cd845267ef3e1f51f146a170eb465b4">_interval_minutes</a> = 5</td></tr>
<tr class="separator:a9cd845267ef3e1f51f146a170eb465b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7fccf67a2d08e29ceecaec2a32a06e2"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#ad7fccf67a2d08e29ceecaec2a32a06e2">_previous_acc</a></td></tr>
<tr class="memdesc:ad7fccf67a2d08e29ceecaec2a32a06e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">There are two accumulator, 0(previous) and 1 (current).  <a href="#ad7fccf67a2d08e29ceecaec2a32a06e2">More...</a><br/></td></tr>
<tr class="separator:ad7fccf67a2d08e29ceecaec2a32a06e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aad5104e425f910525070307cde2831"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a4aad5104e425f910525070307cde2831">_acc</a></td></tr>
<tr class="memdesc:a4aad5104e425f910525070307cde2831"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current interval accumulator, always active and keeps updating.  <a href="#a4aad5104e425f910525070307cde2831">More...</a><br/></td></tr>
<tr class="separator:a4aad5104e425f910525070307cde2831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6681cb0ea036c46369bc5eabd07f37f0"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a6681cb0ea036c46369bc5eabd07f37f0">acc_mutex</a></td></tr>
<tr class="memdesc:a6681cb0ea036c46369bc5eabd07f37f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex to guard the access of the accumulators, since both <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940" title="Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. ">update()</a> and <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117" title="Close the trend interval just ended for this accumulator, if not already closed, calculate the update...">close_interval()</a> might compete for access, and <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487" title="Get the results from the present accumulator. ">get_results()</a> should also have atomic access.  <a href="#a6681cb0ea036c46369bc5eabd07f37f0">More...</a><br/></td></tr>
<tr class="separator:a6681cb0ea036c46369bc5eabd07f37f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accb3c961cc3787f9410dc0052524497e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">datatype</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#accb3c961cc3787f9410dc0052524497e">_channel_datatype</a></td></tr>
<tr class="memdesc:accb3c961cc3787f9410dc0052524497e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The datatype of this trended channel.  <a href="#accb3c961cc3787f9410dc0052524497e">More...</a><br/></td></tr>
<tr class="separator:accb3c961cc3787f9410dc0052524497e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5616dc2432fba2021dd1d5101ddc5e8e"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a5616dc2432fba2021dd1d5101ddc5e8e">_double_max</a> = std::numeric_limits&lt;double&gt;::<a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>()</td></tr>
<tr class="memdesc:a5616dc2432fba2021dd1d5101ddc5e8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the double max limit.  <a href="#a5616dc2432fba2021dd1d5101ddc5e8e">More...</a><br/></td></tr>
<tr class="separator:a5616dc2432fba2021dd1d5101ddc5e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631092d1ff8310770cfc286b38ea2153"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a631092d1ff8310770cfc286b38ea2153">_double_min</a> = std::numeric_limits&lt;double&gt;::<a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>()</td></tr>
<tr class="memdesc:a631092d1ff8310770cfc286b38ea2153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the double min limit.  <a href="#a631092d1ff8310770cfc286b38ea2153">More...</a><br/></td></tr>
<tr class="separator:a631092d1ff8310770cfc286b38ea2153"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Represents an accumulator of values for one channel's data. </p>
<p>Note that this accumulates min, avg, max, and actual regardless of the channel's desired trend traits. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00023">23</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5fb52844a02c43bc32496693135efd21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">px::CTrendAccumulator::CTrendAccumulator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default constructor. </p>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00010">10</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a87a6d542367a33931a33431d1b7754dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">px::CTrendAccumulator::CTrendAccumulator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html">CTrendAccumulator</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>Object used to initialize this channel </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00018">18</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac1dcaca4a1f51895a4c445c077249725"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/dec/data__validation__subscription_8hpp.html#ad17d551e31d1828c68acf40684849b7e">PUBLIC</a> px::CTrendAccumulator::~CTrendAccumulator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00047">47</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a0a68747b8f4a610bf01ba3f786b01940"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void px::CTrendAccumulator::update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/d7d/classpx_1_1CWallTime.html">px::CWallTime</a> &amp;&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/dd9/classpx_1_1CValue.html">px::CValue</a> &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a>&#160;</td>
          <td class="paramname"><em>channel_datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>trend_stage_update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">timestamp</td><td>Timestamp for the given value (UTC clock time) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">value</td><td>The new value to be used in the update. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">channel_datatype</td><td>The type for the channel's value, associated with this accumulator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">trend_stage_update</td><td>If not empty on return, it will contain the information to be stored for this channel for the previous (just ended) interval. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00028">28</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

<p>References <a class="el" href="../../d2/dc0/value_8cpp_source.html#l00307">px::CValue::as_string()</a>, <a class="el" href="../../d7/d3d/adapter_8cpp_source.html#l05552">px::db::get_normalized_interval_timestamp()</a>, and <a class="el" href="../../d4/d3d/log_8hpp_source.html#l00190">LIBPX_FNOTICE</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d43/classpx_1_1CTrendAccumulator_a0a68747b8f4a610bf01ba3f786b01940_cgraph.png" border="0" usemap="#db/d43/classpx_1_1CTrendAccumulator_a0a68747b8f4a610bf01ba3f786b01940_cgraph" alt=""/></div>
<map name="db/d43/classpx_1_1CTrendAccumulator_a0a68747b8f4a610bf01ba3f786b01940_cgraph" id="db/d43/classpx_1_1CTrendAccumulator_a0a68747b8f4a610bf01ba3f786b01940_cgraph">
<area shape="rect" id="node2" href="../../db/dd9/classpx_1_1CValue.html#a746a26c3a4970db4ea4f27f30c5d4d9a" title="Conversion to string type. " alt="" coords="233,5,391,32"/><area shape="rect" id="node3" href="../../dd/d42/namespacepx_1_1db.html#a93c327007ff894fa4691acbf52269ede" title="Gets the minutes since epoch, or zero if invalid, optionally aligned to an interval in minutes; and a..." alt="" coords="227,57,397,98"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3eb59efcc2c972178ac960f7e1261117"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">px::CTrendStageUpdate</a> &gt; px::CTrendAccumulator::close_interval </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ended_interval_mins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>next_interval_mins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close the trend interval just ended for this accumulator, if not already closed, calculate the update for the stage, and swap the active accumulator to the inactive one. </p>
<p>If there were no updates to this channel's accumulator in the last interval, then just update its timestamp to that of the newly closed interval, so its data is "refreshed".</p>
<p>This method differs from the <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940" title="Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. ">update()</a> method in that it closes the interval based simply on the clock, not because the value has been updated. This helps ensure that the trend intervals for lower priority channels (less frequently updated) are dependably closed in a timely manner.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ended_interval_mins</td><td>The just-ended interval time (normalized to minutes UTC since 1970). </td></tr>
    <tr><td class="paramname">next_interval_mins</td><td>The interval time for the new (ie, next) interval, in minutes UTC since 1970.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If not empty on return, it will contain the trend data to be stored for this channel for the just ended interval. If the trend interval had already been closed (eg, by the <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940" title="Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. ">update()</a> method), then this will also be empty. </dd></dl>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00152">152</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

<p>References <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00024">unlikely</a>.</p>

</div>
</div>
<a class="anchor" id="aa574427d2c34bb7fa8200d47d9846487"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void px::CTrendAccumulator::get_results </td>
          <td>(</td>
          <td class="paramtype">uint32_t &amp;&#160;</td>
          <td class="paramname"><em>interval_timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>acc_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>acc_avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>acc_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>acc_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>acc_actual</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the results from the present accumulator. </p>
<p>If there is no present accumulator, will return 0 for timestamp, and NAN for min/avg/max/actual If the count is zero, the values will all be NAN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">interval_timestamp</td><td>The (ending) time, in UTC minutes, for the present accumulator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acc_count</td><td>The count of samples in the interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acc_avg</td><td>The accumulated average value, if any (else NAN). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acc_min</td><td>The minimum value for the interval (so far), if any (else NAN). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acc_max</td><td>The maximum value for the interval (so far), if any (else NAN). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">acc_actual</td><td>The last update value for the interval, if any (else NAN). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00222">222</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3eedf872067958962540cfee00ae64cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void px::CTrendAccumulator::store_results </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">px::datatype</a>&#160;</td>
          <td class="paramname"><em>channel_datatype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">CTrendStageUpdate</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>trend_stage_update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores the results from the current (active) accumulator to a structure for the stage. </p>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00128">128</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

<p>References <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909">px::avg</a>, <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">px::max</a>, and <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">px::min</a>.</p>

</div>
</div>
<a class="anchor" id="ae0a89690aef84c13be41d46c57539f05"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt; <a class="el" href="../../d7/d19/classpx_1_1CTrendStageUpdate.html">px::CTrendStageUpdate</a> &gt; px::CTrendAccumulator::store_previous_results </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores the results from the previous accumulator to a structure for the stage. </p>
<dl class="section return"><dt>Returns</dt><dd>Contains the trend data for this channel from the previous interval, to be stored. If the previous accumulator is (unexpectedly) empty, then this will be empty. </dd></dl>

<p>Definition at line <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html#l00195">195</a> of file <a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a>.</p>

<p>References <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88eae322d423f075b0ab2daad27011d24909">px::avg</a>, <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">px::max</a>, and <a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">px::min</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9cd845267ef3e1f51f146a170eb465b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint32_t px::CTrendAccumulator::_interval_minutes = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00119">119</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad7fccf67a2d08e29ceecaec2a32a06e2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>&gt; px::CTrendAccumulator::_previous_acc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>There are two accumulator, 0(previous) and 1 (current). </p>
<p>They keep rotate in accumulating updates. When 0 is done for an interval, 1 will be used for the next interval, then 0 will be used again, and so on. The reason to keep two of them is to continue accumulation when data are a few seconds out of order, due to the system clock adjustment. When the system clock is adjusted for more than 5 minutes, the results will be overwritten.</p>
<p>Always store the accumulator 0, and always write to the accumulator 1. The previous interval accumulator, always mature and ready to be stored. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00135">135</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4aad5104e425f910525070307cde2831"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="../../de/d1e/classpx_1_1CValueAccumulator.html">CValueAccumulator</a>&gt; px::CTrendAccumulator::_acc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The current interval accumulator, always active and keeps updating. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00139">139</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6681cb0ea036c46369bc5eabd07f37f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex px::CTrendAccumulator::acc_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutex to guard the access of the accumulators, since both <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a0a68747b8f4a610bf01ba3f786b01940" title="Update the time+value to the accumulator, if mature (the time points to the next interval, calculate the update for the stage, and then reset the accumulator and update it for the next interval. ">update()</a> and <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#a3eb59efcc2c972178ac960f7e1261117" title="Close the trend interval just ended for this accumulator, if not already closed, calculate the update...">close_interval()</a> might compete for access, and <a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html#aa574427d2c34bb7fa8200d47d9846487" title="Get the results from the present accumulator. ">get_results()</a> should also have atomic access. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00146">146</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="accb3c961cc3787f9410dc0052524497e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dcb/namespacepx.html#a8231daeb7713d1005025954bc1066422">datatype</a> px::CTrendAccumulator::_channel_datatype</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The datatype of this trended channel. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00151">151</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5616dc2432fba2021dd1d5101ddc5e8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double px::CTrendAccumulator::_double_max = std::numeric_limits&lt;double&gt;::<a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ea2ffe4e77325d9a7152f7086ea7aa5114">max</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Represents the double max limit. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00156">156</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a631092d1ff8310770cfc286b38ea2153"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double px::CTrendAccumulator::_double_min = std::numeric_limits&lt;double&gt;::<a class="el" href="../../de/dcb/namespacepx.html#ad12d789c5d68195a181e6ec438d6f88ead8bd79cc131920d5de426f914d17405a">min</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Represents the double min limit. </p>

<p>Definition at line <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html#l00160">160</a> of file <a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d05/trend__accumulator_8hpp_source.html">trend_accumulator.hpp</a></li>
<li><a class="el" href="../../db/dde/trend__accumulator_8cpp_source.html">trend_accumulator.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/dcb/namespacepx.html">px</a></li><li class="navelem"><a class="el" href="../../db/d43/classpx_1_1CTrendAccumulator.html">CTrendAccumulator</a></li>
    <li class="footer">Generated on Fri May 7 2021 20:24:21 for libpx by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
